inline void transform_point_rotated_mirror_tait_bryan_wc(double &x, double &y, double &z, double &px, double &py, double &pz, double &om, double &fi, double &ka, double &ray_dir_x, double &ray_dir_y, double &ray_dir_z, double &ray_length, double &plane_a, double &plane_b, double &plane_c, double &plane_d, double &om_mirror, double &pxc, double &pyc, double &pzc, double &omc, double &fic, double &kac)
{x = px + (plane_d*ray_dir_x/(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))) - (-ray_dir_x + (2*ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + 2*ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + 2*ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))))*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))))*(ray_length - sqrt(pow(plane_d, 2)*pow(ray_dir_x, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_y, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_z, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2))))*cos(fi)*cos(ka) - (plane_d*ray_dir_y/(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))) - (-ray_dir_y + (plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror)))*(2*ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + 2*ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + 2*ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))))*(ray_length - sqrt(pow(plane_d, 2)*pow(ray_dir_x, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_y, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_z, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2))))*sin(ka)*cos(fi) + (plane_d*ray_dir_y/(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))) - (-ray_dir_z + (plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))*(2*ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + 2*ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + 2*ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))))*(ray_length - sqrt(pow(plane_d, 2)*pow(ray_dir_x, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_y, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_z, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2))))*sin(fi);
y = py + (plane_d*ray_dir_x/(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))) - (-ray_dir_x + (2*ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + 2*ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + 2*ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))))*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))))*(ray_length - sqrt(pow(plane_d, 2)*pow(ray_dir_x, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_y, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_z, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2))))*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + (plane_d*ray_dir_y/(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))) - (-ray_dir_y + (plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror)))*(2*ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + 2*ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + 2*ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))))*(ray_length - sqrt(pow(plane_d, 2)*pow(ray_dir_x, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_y, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_z, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2))))*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - (plane_d*ray_dir_y/(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))) - (-ray_dir_z + (plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))*(2*ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + 2*ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + 2*ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))))*(ray_length - sqrt(pow(plane_d, 2)*pow(ray_dir_x, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_y, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_z, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2))))*sin(om)*cos(fi);
z = pz + (plane_d*ray_dir_x/(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))) - (-ray_dir_x + (2*ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + 2*ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + 2*ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))))*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))))*(ray_length - sqrt(pow(plane_d, 2)*pow(ray_dir_x, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_y, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_z, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2))))*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + (plane_d*ray_dir_y/(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))) - (-ray_dir_y + (plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror)))*(2*ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + 2*ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + 2*ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))))*(ray_length - sqrt(pow(plane_d, 2)*pow(ray_dir_x, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_y, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_z, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2))))*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + (plane_d*ray_dir_y/(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))) - (-ray_dir_z + (plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))*(2*ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + 2*ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + 2*ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))))*(ray_length - sqrt(pow(plane_d, 2)*pow(ray_dir_x, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_y, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_z, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2))))*cos(fi)*cos(om);
}
inline void point_to_point_source_to_target_rotated_mirror_tait_bryan_wc_jacobian(Eigen::Matrix<double, 3, 14, Eigen::RowMajor> &j, double &px, double &py, double &pz, double &om, double &fi, double &ka, double &ray_dir_x, double &ray_dir_y, double &ray_dir_z, double &ray_length, double &plane_a, double &plane_b, double &plane_c, double &plane_d, double &x_t, double &y_t, double &z_t, double &om_mirror, double &pxc, double &pyc, double &pzc, double &omc, double &fic, double &kac)
{j.coeffRef(0,0) = -1;
j.coeffRef(0,1) = 0;
j.coeffRef(0,2) = 0;
j.coeffRef(0,3) = 0;
j.coeffRef(0,4) = -(-plane_d*ray_dir_x/(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))) + (-ray_dir_x + (2*ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + 2*ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + 2*ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))))*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))))*(ray_length - sqrt(pow(plane_d, 2)*pow(ray_dir_x, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_y, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_z, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2))))*sin(fi)*cos(ka) + (-plane_d*ray_dir_y/(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))) + (-ray_dir_z + (plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))*(2*ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + 2*ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + 2*ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))))*(ray_length - sqrt(pow(plane_d, 2)*pow(ray_dir_x, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_y, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_z, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2))))*cos(fi) - (plane_d*ray_dir_y/(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))) - (-ray_dir_y + (plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror)))*(2*ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + 2*ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + 2*ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))))*(ray_length - sqrt(pow(plane_d, 2)*pow(ray_dir_x, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_y, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_z, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2))))*sin(fi)*sin(ka);
j.coeffRef(0,5) = -(-plane_d*ray_dir_x/(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))) + (-ray_dir_x + (2*ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + 2*ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + 2*ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))))*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))))*(ray_length - sqrt(pow(plane_d, 2)*pow(ray_dir_x, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_y, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_z, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2))))*sin(ka)*cos(fi) + (plane_d*ray_dir_y/(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))) - (-ray_dir_y + (plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror)))*(2*ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + 2*ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + 2*ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))))*(ray_length - sqrt(pow(plane_d, 2)*pow(ray_dir_x, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_y, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_z, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2))))*cos(fi)*cos(ka);
j.coeffRef(0,6) = (-plane_d*ray_dir_x*(-ray_dir_x*cos(fic)*cos(kac) - ray_dir_y*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) - ray_dir_z*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)))/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) - (-ray_dir_x + (2*ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + 2*ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + 2*ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))))*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))))*((1.0/2.0)*pow(plane_d, 2)*pow(ray_dir_x, 2)*(-2*ray_dir_x*cos(fic)*cos(kac) - 2*ray_dir_y*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) - 2*ray_dir_z*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)))/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 3) + (1.0/2.0)*pow(plane_d, 2)*pow(ray_dir_y, 2)*(-2*ray_dir_x*cos(fic)*cos(kac) - 2*ray_dir_y*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) - 2*ray_dir_z*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)))/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 3) + (1.0/2.0)*pow(plane_d, 2)*pow(ray_dir_z, 2)*(-2*ray_dir_x*cos(fic)*cos(kac) - 2*ray_dir_y*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) - 2*ray_dir_z*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)))/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 3))/sqrt(pow(plane_d, 2)*pow(ray_dir_x, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_y, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_z, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2)) - (-ray_length + sqrt(pow(plane_d, 2)*pow(ray_dir_x, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_y, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_z, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2)))*((2*ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + 2*ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + 2*ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))))*cos(fic)*cos(kac) + (plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic)))*(2*ray_dir_x*cos(fic)*cos(kac) + 2*ray_dir_y*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + 2*ray_dir_z*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)))))*cos(fi)*cos(ka) + (-plane_d*ray_dir_y*(-ray_dir_x*cos(fic)*cos(kac) - ray_dir_y*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) - ray_dir_z*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)))/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) - (-ray_dir_z + (plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))*(2*ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + 2*ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + 2*ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))))*((1.0/2.0)*pow(plane_d, 2)*pow(ray_dir_x, 2)*(-2*ray_dir_x*cos(fic)*cos(kac) - 2*ray_dir_y*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) - 2*ray_dir_z*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)))/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 3) + (1.0/2.0)*pow(plane_d, 2)*pow(ray_dir_y, 2)*(-2*ray_dir_x*cos(fic)*cos(kac) - 2*ray_dir_y*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) - 2*ray_dir_z*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)))/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 3) + (1.0/2.0)*pow(plane_d, 2)*pow(ray_dir_z, 2)*(-2*ray_dir_x*cos(fic)*cos(kac) - 2*ray_dir_y*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) - 2*ray_dir_z*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)))/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 3))/sqrt(pow(plane_d, 2)*pow(ray_dir_x, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_y, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_z, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2)) - (-ray_length + sqrt(pow(plane_d, 2)*pow(ray_dir_x, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_y, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_z, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2)))*((-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc))*(2*ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + 2*ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + 2*ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))) + (plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))*(2*ray_dir_x*cos(fic)*cos(kac) + 2*ray_dir_y*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + 2*ray_dir_z*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)))))*sin(fi) + (plane_d*ray_dir_y*(-ray_dir_x*cos(fic)*cos(kac) - ray_dir_y*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) - ray_dir_z*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)))/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + (-ray_dir_y + (plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror)))*(2*ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + 2*ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + 2*ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))))*((1.0/2.0)*pow(plane_d, 2)*pow(ray_dir_x, 2)*(-2*ray_dir_x*cos(fic)*cos(kac) - 2*ray_dir_y*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) - 2*ray_dir_z*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)))/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 3) + (1.0/2.0)*pow(plane_d, 2)*pow(ray_dir_y, 2)*(-2*ray_dir_x*cos(fic)*cos(kac) - 2*ray_dir_y*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) - 2*ray_dir_z*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)))/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 3) + (1.0/2.0)*pow(plane_d, 2)*pow(ray_dir_z, 2)*(-2*ray_dir_x*cos(fic)*cos(kac) - 2*ray_dir_y*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) - 2*ray_dir_z*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)))/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 3))/sqrt(pow(plane_d, 2)*pow(ray_dir_x, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_y, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_z, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2)) + (-ray_length + sqrt(pow(plane_d, 2)*pow(ray_dir_x, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_y, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_z, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2)))*((sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc))*(2*ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + 2*ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + 2*ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))) + (plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror)))*(2*ray_dir_x*cos(fic)*cos(kac) + 2*ray_dir_y*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + 2*ray_dir_z*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)))))*sin(ka)*cos(fi);
j.coeffRef(0,7) = (-plane_d*ray_dir_x*(-ray_dir_x*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) - ray_dir_y*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) - ray_dir_z*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)))/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) - (-ray_dir_x + (2*ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + 2*ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + 2*ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))))*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))))*((1.0/2.0)*pow(plane_d, 2)*pow(ray_dir_x, 2)*(-2*ray_dir_x*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) - 2*ray_dir_y*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) - 2*ray_dir_z*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)))/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 3) + (1.0/2.0)*pow(plane_d, 2)*pow(ray_dir_y, 2)*(-2*ray_dir_x*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) - 2*ray_dir_y*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) - 2*ray_dir_z*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)))/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 3) + (1.0/2.0)*pow(plane_d, 2)*pow(ray_dir_z, 2)*(-2*ray_dir_x*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) - 2*ray_dir_y*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) - 2*ray_dir_z*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)))/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 3))/sqrt(pow(plane_d, 2)*pow(ray_dir_x, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_y, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_z, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2)) - (-ray_length + sqrt(pow(plane_d, 2)*pow(ray_dir_x, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_y, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_z, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2)))*((sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror))*(2*ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + 2*ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + 2*ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))) + (2*ray_dir_x*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + 2*ray_dir_y*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + 2*ray_dir_z*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)))*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic)))))*cos(fi)*cos(ka) + (-plane_d*ray_dir_y*(-ray_dir_x*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) - ray_dir_y*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) - ray_dir_z*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)))/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) - (-ray_dir_z + (plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))*(2*ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + 2*ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + 2*ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))))*((1.0/2.0)*pow(plane_d, 2)*pow(ray_dir_x, 2)*(-2*ray_dir_x*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) - 2*ray_dir_y*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) - 2*ray_dir_z*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)))/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 3) + (1.0/2.0)*pow(plane_d, 2)*pow(ray_dir_y, 2)*(-2*ray_dir_x*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) - 2*ray_dir_y*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) - 2*ray_dir_z*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)))/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 3) + (1.0/2.0)*pow(plane_d, 2)*pow(ray_dir_z, 2)*(-2*ray_dir_x*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) - 2*ray_dir_y*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) - 2*ray_dir_z*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)))/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 3))/sqrt(pow(plane_d, 2)*pow(ray_dir_x, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_y, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_z, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2)) - (-ray_length + sqrt(pow(plane_d, 2)*pow(ray_dir_x, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_y, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_z, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2)))*(((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc))*(2*ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + 2*ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + 2*ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))) + (plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))*(2*ray_dir_x*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + 2*ray_dir_y*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + 2*ray_dir_z*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)))))*sin(fi) + (plane_d*ray_dir_y*(-ray_dir_x*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) - ray_dir_y*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) - ray_dir_z*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)))/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + (-ray_dir_y + (plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror)))*(2*ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + 2*ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + 2*ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))))*((1.0/2.0)*pow(plane_d, 2)*pow(ray_dir_x, 2)*(-2*ray_dir_x*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) - 2*ray_dir_y*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) - 2*ray_dir_z*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)))/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 3) + (1.0/2.0)*pow(plane_d, 2)*pow(ray_dir_y, 2)*(-2*ray_dir_x*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) - 2*ray_dir_y*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) - 2*ray_dir_z*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)))/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 3) + (1.0/2.0)*pow(plane_d, 2)*pow(ray_dir_z, 2)*(-2*ray_dir_x*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) - 2*ray_dir_y*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) - 2*ray_dir_z*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)))/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 3))/sqrt(pow(plane_d, 2)*pow(ray_dir_x, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_y, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_z, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2)) + (-ray_length + sqrt(pow(plane_d, 2)*pow(ray_dir_x, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_y, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_z, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2)))*(((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic))*(2*ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + 2*ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + 2*ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))) + (plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror)))*(2*ray_dir_x*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + 2*ray_dir_y*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + 2*ray_dir_z*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)))))*sin(ka)*cos(fi);
j.coeffRef(0,8) = (-plane_d*ray_dir_x*(-ray_dir_x*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic)) - ray_dir_y*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror)) - ray_dir_z*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) - (-ray_dir_x + (2*ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + 2*ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + 2*ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))))*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))))*((1.0/2.0)*pow(plane_d, 2)*pow(ray_dir_x, 2)*(-2*ray_dir_x*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic)) - 2*ray_dir_y*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror)) - 2*ray_dir_z*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 3) + (1.0/2.0)*pow(plane_d, 2)*pow(ray_dir_y, 2)*(-2*ray_dir_x*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic)) - 2*ray_dir_y*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror)) - 2*ray_dir_z*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 3) + (1.0/2.0)*pow(plane_d, 2)*pow(ray_dir_z, 2)*(-2*ray_dir_x*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic)) - 2*ray_dir_y*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror)) - 2*ray_dir_z*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 3))/sqrt(pow(plane_d, 2)*pow(ray_dir_x, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_y, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_z, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2)) - (-ray_length + sqrt(pow(plane_d, 2)*pow(ray_dir_x, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_y, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_z, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2)))*((sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))*(2*ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + 2*ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + 2*ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))) + (2*ray_dir_x*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic)) + 2*ray_dir_y*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror)) + 2*ray_dir_z*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic)))))*cos(fi)*cos(ka) + (-plane_d*ray_dir_y*(-ray_dir_x*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic)) - ray_dir_y*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror)) - ray_dir_z*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) - (-ray_dir_z + (plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))*(2*ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + 2*ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + 2*ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))))*((1.0/2.0)*pow(plane_d, 2)*pow(ray_dir_x, 2)*(-2*ray_dir_x*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic)) - 2*ray_dir_y*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror)) - 2*ray_dir_z*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 3) + (1.0/2.0)*pow(plane_d, 2)*pow(ray_dir_y, 2)*(-2*ray_dir_x*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic)) - 2*ray_dir_y*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror)) - 2*ray_dir_z*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 3) + (1.0/2.0)*pow(plane_d, 2)*pow(ray_dir_z, 2)*(-2*ray_dir_x*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic)) - 2*ray_dir_y*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror)) - 2*ray_dir_z*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 3))/sqrt(pow(plane_d, 2)*pow(ray_dir_x, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_y, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_z, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2)) - (-ray_length + sqrt(pow(plane_d, 2)*pow(ray_dir_x, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_y, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_z, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2)))*((-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))*(2*ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + 2*ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + 2*ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))) + (plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))*(2*ray_dir_x*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic)) + 2*ray_dir_y*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror)) + 2*ray_dir_z*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))))*sin(fi) + (plane_d*ray_dir_y*(-ray_dir_x*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic)) - ray_dir_y*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror)) - ray_dir_z*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + (-ray_dir_y + (plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror)))*(2*ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + 2*ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + 2*ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))))*((1.0/2.0)*pow(plane_d, 2)*pow(ray_dir_x, 2)*(-2*ray_dir_x*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic)) - 2*ray_dir_y*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror)) - 2*ray_dir_z*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 3) + (1.0/2.0)*pow(plane_d, 2)*pow(ray_dir_y, 2)*(-2*ray_dir_x*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic)) - 2*ray_dir_y*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror)) - 2*ray_dir_z*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 3) + (1.0/2.0)*pow(plane_d, 2)*pow(ray_dir_z, 2)*(-2*ray_dir_x*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic)) - 2*ray_dir_y*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror)) - 2*ray_dir_z*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 3))/sqrt(pow(plane_d, 2)*pow(ray_dir_x, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_y, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_z, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2)) + (-ray_length + sqrt(pow(plane_d, 2)*pow(ray_dir_x, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_y, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_z, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2)))*((-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))*(2*ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + 2*ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + 2*ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))) + (plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror)))*(2*ray_dir_x*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic)) + 2*ray_dir_y*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror)) + 2*ray_dir_z*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))))*sin(ka)*cos(fi);
j.coeffRef(0,9) = (-ray_dir_x/(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))) - (-ray_dir_x + (2*ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + 2*ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + 2*ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))))*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))))*(plane_d*pow(ray_dir_x, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + plane_d*pow(ray_dir_y, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + plane_d*pow(ray_dir_z, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2))/sqrt(pow(plane_d, 2)*pow(ray_dir_x, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_y, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_z, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2)))*cos(fi)*cos(ka) + (-ray_dir_y/(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))) - (-ray_dir_z + (plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))*(2*ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + 2*ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + 2*ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))))*(plane_d*pow(ray_dir_x, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + plane_d*pow(ray_dir_y, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + plane_d*pow(ray_dir_z, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2))/sqrt(pow(plane_d, 2)*pow(ray_dir_x, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_y, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_z, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2)))*sin(fi) + (ray_dir_y/(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))) + (-ray_dir_y + (plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror)))*(2*ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + 2*ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + 2*ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))))*(plane_d*pow(ray_dir_x, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + plane_d*pow(ray_dir_y, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + plane_d*pow(ray_dir_z, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2))/sqrt(pow(plane_d, 2)*pow(ray_dir_x, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_y, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_z, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2)))*sin(ka)*cos(fi);
j.coeffRef(0,10) = 0;
j.coeffRef(0,11) = 0;
j.coeffRef(0,12) = (-plane_d*ray_dir_x*(-ray_dir_x*(-plane_a*sin(fic)*cos(kac) + plane_b*(sin(fic)*sin(kac)*cos(om_mirror) + sin(om_mirror)*cos(fic)) + plane_c*(-sin(fic)*sin(kac)*sin(om_mirror) + cos(fic)*cos(om_mirror))) - ray_dir_y*(plane_a*sin(omc)*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror)*sin(omc) - sin(kac)*sin(omc)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*sin(omc)*cos(om_mirror) + sin(kac)*sin(om_mirror)*sin(omc)*cos(fic))) - ray_dir_z*(-plane_a*cos(fic)*cos(kac)*cos(omc) + plane_b*(-sin(fic)*sin(om_mirror)*cos(omc) + sin(kac)*cos(fic)*cos(om_mirror)*cos(omc)) + plane_c*(-sin(fic)*cos(om_mirror)*cos(omc) - sin(kac)*sin(om_mirror)*cos(fic)*cos(omc))))/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) - (-ray_dir_x + (2*ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + 2*ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + 2*ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))))*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))))*((1.0/2.0)*pow(plane_d, 2)*pow(ray_dir_x, 2)*(-2*ray_dir_x*(-plane_a*sin(fic)*cos(kac) + plane_b*(sin(fic)*sin(kac)*cos(om_mirror) + sin(om_mirror)*cos(fic)) + plane_c*(-sin(fic)*sin(kac)*sin(om_mirror) + cos(fic)*cos(om_mirror))) - 2*ray_dir_y*(plane_a*sin(omc)*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror)*sin(omc) - sin(kac)*sin(omc)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*sin(omc)*cos(om_mirror) + sin(kac)*sin(om_mirror)*sin(omc)*cos(fic))) - 2*ray_dir_z*(-plane_a*cos(fic)*cos(kac)*cos(omc) + plane_b*(-sin(fic)*sin(om_mirror)*cos(omc) + sin(kac)*cos(fic)*cos(om_mirror)*cos(omc)) + plane_c*(-sin(fic)*cos(om_mirror)*cos(omc) - sin(kac)*sin(om_mirror)*cos(fic)*cos(omc))))/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 3) + (1.0/2.0)*pow(plane_d, 2)*pow(ray_dir_y, 2)*(-2*ray_dir_x*(-plane_a*sin(fic)*cos(kac) + plane_b*(sin(fic)*sin(kac)*cos(om_mirror) + sin(om_mirror)*cos(fic)) + plane_c*(-sin(fic)*sin(kac)*sin(om_mirror) + cos(fic)*cos(om_mirror))) - 2*ray_dir_y*(plane_a*sin(omc)*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror)*sin(omc) - sin(kac)*sin(omc)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*sin(omc)*cos(om_mirror) + sin(kac)*sin(om_mirror)*sin(omc)*cos(fic))) - 2*ray_dir_z*(-plane_a*cos(fic)*cos(kac)*cos(omc) + plane_b*(-sin(fic)*sin(om_mirror)*cos(omc) + sin(kac)*cos(fic)*cos(om_mirror)*cos(omc)) + plane_c*(-sin(fic)*cos(om_mirror)*cos(omc) - sin(kac)*sin(om_mirror)*cos(fic)*cos(omc))))/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 3) + (1.0/2.0)*pow(plane_d, 2)*pow(ray_dir_z, 2)*(-2*ray_dir_x*(-plane_a*sin(fic)*cos(kac) + plane_b*(sin(fic)*sin(kac)*cos(om_mirror) + sin(om_mirror)*cos(fic)) + plane_c*(-sin(fic)*sin(kac)*sin(om_mirror) + cos(fic)*cos(om_mirror))) - 2*ray_dir_y*(plane_a*sin(omc)*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror)*sin(omc) - sin(kac)*sin(omc)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*sin(omc)*cos(om_mirror) + sin(kac)*sin(om_mirror)*sin(omc)*cos(fic))) - 2*ray_dir_z*(-plane_a*cos(fic)*cos(kac)*cos(omc) + plane_b*(-sin(fic)*sin(om_mirror)*cos(omc) + sin(kac)*cos(fic)*cos(om_mirror)*cos(omc)) + plane_c*(-sin(fic)*cos(om_mirror)*cos(omc) - sin(kac)*sin(om_mirror)*cos(fic)*cos(omc))))/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 3))/sqrt(pow(plane_d, 2)*pow(ray_dir_x, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_y, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_z, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2)) - (-ray_length + sqrt(pow(plane_d, 2)*pow(ray_dir_x, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_y, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_z, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2)))*((2*ray_dir_x*(-plane_a*sin(fic)*cos(kac) + plane_b*(sin(fic)*sin(kac)*cos(om_mirror) + sin(om_mirror)*cos(fic)) + plane_c*(-sin(fic)*sin(kac)*sin(om_mirror) + cos(fic)*cos(om_mirror))) + 2*ray_dir_y*(plane_a*sin(omc)*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror)*sin(omc) - sin(kac)*sin(omc)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*sin(omc)*cos(om_mirror) + sin(kac)*sin(om_mirror)*sin(omc)*cos(fic))) + 2*ray_dir_z*(-plane_a*cos(fic)*cos(kac)*cos(omc) + plane_b*(-sin(fic)*sin(om_mirror)*cos(omc) + sin(kac)*cos(fic)*cos(om_mirror)*cos(omc)) + plane_c*(-sin(fic)*cos(om_mirror)*cos(omc) - sin(kac)*sin(om_mirror)*cos(fic)*cos(omc))))*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + (2*ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + 2*ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + 2*ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))))*(-plane_a*sin(fic)*cos(kac) + plane_b*(sin(fic)*sin(kac)*cos(om_mirror) + sin(om_mirror)*cos(fic)) + plane_c*(-sin(fic)*sin(kac)*sin(om_mirror) + cos(fic)*cos(om_mirror)))))*cos(fi)*cos(ka) + (-plane_d*ray_dir_y*(-ray_dir_x*(-plane_a*sin(fic)*cos(kac) + plane_b*(sin(fic)*sin(kac)*cos(om_mirror) + sin(om_mirror)*cos(fic)) + plane_c*(-sin(fic)*sin(kac)*sin(om_mirror) + cos(fic)*cos(om_mirror))) - ray_dir_y*(plane_a*sin(omc)*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror)*sin(omc) - sin(kac)*sin(omc)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*sin(omc)*cos(om_mirror) + sin(kac)*sin(om_mirror)*sin(omc)*cos(fic))) - ray_dir_z*(-plane_a*cos(fic)*cos(kac)*cos(omc) + plane_b*(-sin(fic)*sin(om_mirror)*cos(omc) + sin(kac)*cos(fic)*cos(om_mirror)*cos(omc)) + plane_c*(-sin(fic)*cos(om_mirror)*cos(omc) - sin(kac)*sin(om_mirror)*cos(fic)*cos(omc))))/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) - (-ray_dir_z + (plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))*(2*ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + 2*ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + 2*ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))))*((1.0/2.0)*pow(plane_d, 2)*pow(ray_dir_x, 2)*(-2*ray_dir_x*(-plane_a*sin(fic)*cos(kac) + plane_b*(sin(fic)*sin(kac)*cos(om_mirror) + sin(om_mirror)*cos(fic)) + plane_c*(-sin(fic)*sin(kac)*sin(om_mirror) + cos(fic)*cos(om_mirror))) - 2*ray_dir_y*(plane_a*sin(omc)*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror)*sin(omc) - sin(kac)*sin(omc)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*sin(omc)*cos(om_mirror) + sin(kac)*sin(om_mirror)*sin(omc)*cos(fic))) - 2*ray_dir_z*(-plane_a*cos(fic)*cos(kac)*cos(omc) + plane_b*(-sin(fic)*sin(om_mirror)*cos(omc) + sin(kac)*cos(fic)*cos(om_mirror)*cos(omc)) + plane_c*(-sin(fic)*cos(om_mirror)*cos(omc) - sin(kac)*sin(om_mirror)*cos(fic)*cos(omc))))/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 3) + (1.0/2.0)*pow(plane_d, 2)*pow(ray_dir_y, 2)*(-2*ray_dir_x*(-plane_a*sin(fic)*cos(kac) + plane_b*(sin(fic)*sin(kac)*cos(om_mirror) + sin(om_mirror)*cos(fic)) + plane_c*(-sin(fic)*sin(kac)*sin(om_mirror) + cos(fic)*cos(om_mirror))) - 2*ray_dir_y*(plane_a*sin(omc)*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror)*sin(omc) - sin(kac)*sin(omc)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*sin(omc)*cos(om_mirror) + sin(kac)*sin(om_mirror)*sin(omc)*cos(fic))) - 2*ray_dir_z*(-plane_a*cos(fic)*cos(kac)*cos(omc) + plane_b*(-sin(fic)*sin(om_mirror)*cos(omc) + sin(kac)*cos(fic)*cos(om_mirror)*cos(omc)) + plane_c*(-sin(fic)*cos(om_mirror)*cos(omc) - sin(kac)*sin(om_mirror)*cos(fic)*cos(omc))))/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 3) + (1.0/2.0)*pow(plane_d, 2)*pow(ray_dir_z, 2)*(-2*ray_dir_x*(-plane_a*sin(fic)*cos(kac) + plane_b*(sin(fic)*sin(kac)*cos(om_mirror) + sin(om_mirror)*cos(fic)) + plane_c*(-sin(fic)*sin(kac)*sin(om_mirror) + cos(fic)*cos(om_mirror))) - 2*ray_dir_y*(plane_a*sin(omc)*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror)*sin(omc) - sin(kac)*sin(omc)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*sin(omc)*cos(om_mirror) + sin(kac)*sin(om_mirror)*sin(omc)*cos(fic))) - 2*ray_dir_z*(-plane_a*cos(fic)*cos(kac)*cos(omc) + plane_b*(-sin(fic)*sin(om_mirror)*cos(omc) + sin(kac)*cos(fic)*cos(om_mirror)*cos(omc)) + plane_c*(-sin(fic)*cos(om_mirror)*cos(omc) - sin(kac)*sin(om_mirror)*cos(fic)*cos(omc))))/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 3))/sqrt(pow(plane_d, 2)*pow(ray_dir_x, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_y, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_z, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2)) - (-ray_length + sqrt(pow(plane_d, 2)*pow(ray_dir_x, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_y, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_z, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2)))*((plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))*(2*ray_dir_x*(-plane_a*sin(fic)*cos(kac) + plane_b*(sin(fic)*sin(kac)*cos(om_mirror) + sin(om_mirror)*cos(fic)) + plane_c*(-sin(fic)*sin(kac)*sin(om_mirror) + cos(fic)*cos(om_mirror))) + 2*ray_dir_y*(plane_a*sin(omc)*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror)*sin(omc) - sin(kac)*sin(omc)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*sin(omc)*cos(om_mirror) + sin(kac)*sin(om_mirror)*sin(omc)*cos(fic))) + 2*ray_dir_z*(-plane_a*cos(fic)*cos(kac)*cos(omc) + plane_b*(-sin(fic)*sin(om_mirror)*cos(omc) + sin(kac)*cos(fic)*cos(om_mirror)*cos(omc)) + plane_c*(-sin(fic)*cos(om_mirror)*cos(omc) - sin(kac)*sin(om_mirror)*cos(fic)*cos(omc)))) + (2*ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + 2*ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + 2*ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))))*(-plane_a*cos(fic)*cos(kac)*cos(omc) + plane_b*(-sin(fic)*sin(om_mirror)*cos(omc) + sin(kac)*cos(fic)*cos(om_mirror)*cos(omc)) + plane_c*(-sin(fic)*cos(om_mirror)*cos(omc) - sin(kac)*sin(om_mirror)*cos(fic)*cos(omc)))))*sin(fi) + (plane_d*ray_dir_y*(-ray_dir_x*(-plane_a*sin(fic)*cos(kac) + plane_b*(sin(fic)*sin(kac)*cos(om_mirror) + sin(om_mirror)*cos(fic)) + plane_c*(-sin(fic)*sin(kac)*sin(om_mirror) + cos(fic)*cos(om_mirror))) - ray_dir_y*(plane_a*sin(omc)*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror)*sin(omc) - sin(kac)*sin(omc)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*sin(omc)*cos(om_mirror) + sin(kac)*sin(om_mirror)*sin(omc)*cos(fic))) - ray_dir_z*(-plane_a*cos(fic)*cos(kac)*cos(omc) + plane_b*(-sin(fic)*sin(om_mirror)*cos(omc) + sin(kac)*cos(fic)*cos(om_mirror)*cos(omc)) + plane_c*(-sin(fic)*cos(om_mirror)*cos(omc) - sin(kac)*sin(om_mirror)*cos(fic)*cos(omc))))/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + (-ray_dir_y + (plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror)))*(2*ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + 2*ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + 2*ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))))*((1.0/2.0)*pow(plane_d, 2)*pow(ray_dir_x, 2)*(-2*ray_dir_x*(-plane_a*sin(fic)*cos(kac) + plane_b*(sin(fic)*sin(kac)*cos(om_mirror) + sin(om_mirror)*cos(fic)) + plane_c*(-sin(fic)*sin(kac)*sin(om_mirror) + cos(fic)*cos(om_mirror))) - 2*ray_dir_y*(plane_a*sin(omc)*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror)*sin(omc) - sin(kac)*sin(omc)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*sin(omc)*cos(om_mirror) + sin(kac)*sin(om_mirror)*sin(omc)*cos(fic))) - 2*ray_dir_z*(-plane_a*cos(fic)*cos(kac)*cos(omc) + plane_b*(-sin(fic)*sin(om_mirror)*cos(omc) + sin(kac)*cos(fic)*cos(om_mirror)*cos(omc)) + plane_c*(-sin(fic)*cos(om_mirror)*cos(omc) - sin(kac)*sin(om_mirror)*cos(fic)*cos(omc))))/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 3) + (1.0/2.0)*pow(plane_d, 2)*pow(ray_dir_y, 2)*(-2*ray_dir_x*(-plane_a*sin(fic)*cos(kac) + plane_b*(sin(fic)*sin(kac)*cos(om_mirror) + sin(om_mirror)*cos(fic)) + plane_c*(-sin(fic)*sin(kac)*sin(om_mirror) + cos(fic)*cos(om_mirror))) - 2*ray_dir_y*(plane_a*sin(omc)*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror)*sin(omc) - sin(kac)*sin(omc)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*sin(omc)*cos(om_mirror) + sin(kac)*sin(om_mirror)*sin(omc)*cos(fic))) - 2*ray_dir_z*(-plane_a*cos(fic)*cos(kac)*cos(omc) + plane_b*(-sin(fic)*sin(om_mirror)*cos(omc) + sin(kac)*cos(fic)*cos(om_mirror)*cos(omc)) + plane_c*(-sin(fic)*cos(om_mirror)*cos(omc) - sin(kac)*sin(om_mirror)*cos(fic)*cos(omc))))/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 3) + (1.0/2.0)*pow(plane_d, 2)*pow(ray_dir_z, 2)*(-2*ray_dir_x*(-plane_a*sin(fic)*cos(kac) + plane_b*(sin(fic)*sin(kac)*cos(om_mirror) + sin(om_mirror)*cos(fic)) + plane_c*(-sin(fic)*sin(kac)*sin(om_mirror) + cos(fic)*cos(om_mirror))) - 2*ray_dir_y*(plane_a*sin(omc)*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror)*sin(omc) - sin(kac)*sin(omc)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*sin(omc)*cos(om_mirror) + sin(kac)*sin(om_mirror)*sin(omc)*cos(fic))) - 2*ray_dir_z*(-plane_a*cos(fic)*cos(kac)*cos(omc) + plane_b*(-sin(fic)*sin(om_mirror)*cos(omc) + sin(kac)*cos(fic)*cos(om_mirror)*cos(omc)) + plane_c*(-sin(fic)*cos(om_mirror)*cos(omc) - sin(kac)*sin(om_mirror)*cos(fic)*cos(omc))))/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 3))/sqrt(pow(plane_d, 2)*pow(ray_dir_x, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_y, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_z, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2)) + (-ray_length + sqrt(pow(plane_d, 2)*pow(ray_dir_x, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_y, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_z, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2)))*((plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror)))*(2*ray_dir_x*(-plane_a*sin(fic)*cos(kac) + plane_b*(sin(fic)*sin(kac)*cos(om_mirror) + sin(om_mirror)*cos(fic)) + plane_c*(-sin(fic)*sin(kac)*sin(om_mirror) + cos(fic)*cos(om_mirror))) + 2*ray_dir_y*(plane_a*sin(omc)*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror)*sin(omc) - sin(kac)*sin(omc)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*sin(omc)*cos(om_mirror) + sin(kac)*sin(om_mirror)*sin(omc)*cos(fic))) + 2*ray_dir_z*(-plane_a*cos(fic)*cos(kac)*cos(omc) + plane_b*(-sin(fic)*sin(om_mirror)*cos(omc) + sin(kac)*cos(fic)*cos(om_mirror)*cos(omc)) + plane_c*(-sin(fic)*cos(om_mirror)*cos(omc) - sin(kac)*sin(om_mirror)*cos(fic)*cos(omc)))) + (2*ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + 2*ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + 2*ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))))*(plane_a*sin(omc)*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror)*sin(omc) - sin(kac)*sin(omc)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*sin(omc)*cos(om_mirror) + sin(kac)*sin(om_mirror)*sin(omc)*cos(fic)))))*sin(ka)*cos(fi);
j.coeffRef(0,13) = (-plane_d*ray_dir_x*(-ray_dir_x*(-plane_a*sin(kac)*cos(fic) - plane_b*cos(fic)*cos(kac)*cos(om_mirror) + plane_c*sin(om_mirror)*cos(fic)*cos(kac)) - ray_dir_y*(plane_a*(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc)) + plane_b*(-sin(fic)*sin(omc)*cos(kac) - sin(kac)*cos(omc))*cos(om_mirror) + plane_c*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc))*sin(om_mirror)) - ray_dir_z*(plane_a*(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac)) + plane_b*(sin(fic)*cos(kac)*cos(omc) - sin(kac)*sin(omc))*cos(om_mirror) + plane_c*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc))*sin(om_mirror)))/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) - (-ray_dir_x + (2*ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + 2*ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + 2*ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))))*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))))*((1.0/2.0)*pow(plane_d, 2)*pow(ray_dir_x, 2)*(-2*ray_dir_x*(-plane_a*sin(kac)*cos(fic) - plane_b*cos(fic)*cos(kac)*cos(om_mirror) + plane_c*sin(om_mirror)*cos(fic)*cos(kac)) - 2*ray_dir_y*(plane_a*(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc)) + plane_b*(-sin(fic)*sin(omc)*cos(kac) - sin(kac)*cos(omc))*cos(om_mirror) + plane_c*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc))*sin(om_mirror)) - 2*ray_dir_z*(plane_a*(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac)) + plane_b*(sin(fic)*cos(kac)*cos(omc) - sin(kac)*sin(omc))*cos(om_mirror) + plane_c*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc))*sin(om_mirror)))/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 3) + (1.0/2.0)*pow(plane_d, 2)*pow(ray_dir_y, 2)*(-2*ray_dir_x*(-plane_a*sin(kac)*cos(fic) - plane_b*cos(fic)*cos(kac)*cos(om_mirror) + plane_c*sin(om_mirror)*cos(fic)*cos(kac)) - 2*ray_dir_y*(plane_a*(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc)) + plane_b*(-sin(fic)*sin(omc)*cos(kac) - sin(kac)*cos(omc))*cos(om_mirror) + plane_c*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc))*sin(om_mirror)) - 2*ray_dir_z*(plane_a*(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac)) + plane_b*(sin(fic)*cos(kac)*cos(omc) - sin(kac)*sin(omc))*cos(om_mirror) + plane_c*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc))*sin(om_mirror)))/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 3) + (1.0/2.0)*pow(plane_d, 2)*pow(ray_dir_z, 2)*(-2*ray_dir_x*(-plane_a*sin(kac)*cos(fic) - plane_b*cos(fic)*cos(kac)*cos(om_mirror) + plane_c*sin(om_mirror)*cos(fic)*cos(kac)) - 2*ray_dir_y*(plane_a*(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc)) + plane_b*(-sin(fic)*sin(omc)*cos(kac) - sin(kac)*cos(omc))*cos(om_mirror) + plane_c*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc))*sin(om_mirror)) - 2*ray_dir_z*(plane_a*(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac)) + plane_b*(sin(fic)*cos(kac)*cos(omc) - sin(kac)*sin(omc))*cos(om_mirror) + plane_c*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc))*sin(om_mirror)))/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 3))/sqrt(pow(plane_d, 2)*pow(ray_dir_x, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_y, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_z, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2)) - (-ray_length + sqrt(pow(plane_d, 2)*pow(ray_dir_x, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_y, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_z, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2)))*((2*ray_dir_x*(-plane_a*sin(kac)*cos(fic) - plane_b*cos(fic)*cos(kac)*cos(om_mirror) + plane_c*sin(om_mirror)*cos(fic)*cos(kac)) + 2*ray_dir_y*(plane_a*(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc)) + plane_b*(-sin(fic)*sin(omc)*cos(kac) - sin(kac)*cos(omc))*cos(om_mirror) + plane_c*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc))*sin(om_mirror)) + 2*ray_dir_z*(plane_a*(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac)) + plane_b*(sin(fic)*cos(kac)*cos(omc) - sin(kac)*sin(omc))*cos(om_mirror) + plane_c*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc))*sin(om_mirror)))*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + (2*ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + 2*ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + 2*ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))))*(-plane_a*sin(kac)*cos(fic) - plane_b*cos(fic)*cos(kac)*cos(om_mirror) + plane_c*sin(om_mirror)*cos(fic)*cos(kac))))*cos(fi)*cos(ka) + (-plane_d*ray_dir_y*(-ray_dir_x*(-plane_a*sin(kac)*cos(fic) - plane_b*cos(fic)*cos(kac)*cos(om_mirror) + plane_c*sin(om_mirror)*cos(fic)*cos(kac)) - ray_dir_y*(plane_a*(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc)) + plane_b*(-sin(fic)*sin(omc)*cos(kac) - sin(kac)*cos(omc))*cos(om_mirror) + plane_c*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc))*sin(om_mirror)) - ray_dir_z*(plane_a*(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac)) + plane_b*(sin(fic)*cos(kac)*cos(omc) - sin(kac)*sin(omc))*cos(om_mirror) + plane_c*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc))*sin(om_mirror)))/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) - (-ray_dir_z + (plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))*(2*ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + 2*ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + 2*ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))))*((1.0/2.0)*pow(plane_d, 2)*pow(ray_dir_x, 2)*(-2*ray_dir_x*(-plane_a*sin(kac)*cos(fic) - plane_b*cos(fic)*cos(kac)*cos(om_mirror) + plane_c*sin(om_mirror)*cos(fic)*cos(kac)) - 2*ray_dir_y*(plane_a*(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc)) + plane_b*(-sin(fic)*sin(omc)*cos(kac) - sin(kac)*cos(omc))*cos(om_mirror) + plane_c*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc))*sin(om_mirror)) - 2*ray_dir_z*(plane_a*(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac)) + plane_b*(sin(fic)*cos(kac)*cos(omc) - sin(kac)*sin(omc))*cos(om_mirror) + plane_c*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc))*sin(om_mirror)))/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 3) + (1.0/2.0)*pow(plane_d, 2)*pow(ray_dir_y, 2)*(-2*ray_dir_x*(-plane_a*sin(kac)*cos(fic) - plane_b*cos(fic)*cos(kac)*cos(om_mirror) + plane_c*sin(om_mirror)*cos(fic)*cos(kac)) - 2*ray_dir_y*(plane_a*(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc)) + plane_b*(-sin(fic)*sin(omc)*cos(kac) - sin(kac)*cos(omc))*cos(om_mirror) + plane_c*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc))*sin(om_mirror)) - 2*ray_dir_z*(plane_a*(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac)) + plane_b*(sin(fic)*cos(kac)*cos(omc) - sin(kac)*sin(omc))*cos(om_mirror) + plane_c*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc))*sin(om_mirror)))/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 3) + (1.0/2.0)*pow(plane_d, 2)*pow(ray_dir_z, 2)*(-2*ray_dir_x*(-plane_a*sin(kac)*cos(fic) - plane_b*cos(fic)*cos(kac)*cos(om_mirror) + plane_c*sin(om_mirror)*cos(fic)*cos(kac)) - 2*ray_dir_y*(plane_a*(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc)) + plane_b*(-sin(fic)*sin(omc)*cos(kac) - sin(kac)*cos(omc))*cos(om_mirror) + plane_c*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc))*sin(om_mirror)) - 2*ray_dir_z*(plane_a*(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac)) + plane_b*(sin(fic)*cos(kac)*cos(omc) - sin(kac)*sin(omc))*cos(om_mirror) + plane_c*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc))*sin(om_mirror)))/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 3))/sqrt(pow(plane_d, 2)*pow(ray_dir_x, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_y, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_z, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2)) - (-ray_length + sqrt(pow(plane_d, 2)*pow(ray_dir_x, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_y, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_z, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2)))*((plane_a*(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac)) + plane_b*(sin(fic)*cos(kac)*cos(omc) - sin(kac)*sin(omc))*cos(om_mirror) + plane_c*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc))*sin(om_mirror))*(2*ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + 2*ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + 2*ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))) + (plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))*(2*ray_dir_x*(-plane_a*sin(kac)*cos(fic) - plane_b*cos(fic)*cos(kac)*cos(om_mirror) + plane_c*sin(om_mirror)*cos(fic)*cos(kac)) + 2*ray_dir_y*(plane_a*(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc)) + plane_b*(-sin(fic)*sin(omc)*cos(kac) - sin(kac)*cos(omc))*cos(om_mirror) + plane_c*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc))*sin(om_mirror)) + 2*ray_dir_z*(plane_a*(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac)) + plane_b*(sin(fic)*cos(kac)*cos(omc) - sin(kac)*sin(omc))*cos(om_mirror) + plane_c*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc))*sin(om_mirror)))))*sin(fi) + (plane_d*ray_dir_y*(-ray_dir_x*(-plane_a*sin(kac)*cos(fic) - plane_b*cos(fic)*cos(kac)*cos(om_mirror) + plane_c*sin(om_mirror)*cos(fic)*cos(kac)) - ray_dir_y*(plane_a*(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc)) + plane_b*(-sin(fic)*sin(omc)*cos(kac) - sin(kac)*cos(omc))*cos(om_mirror) + plane_c*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc))*sin(om_mirror)) - ray_dir_z*(plane_a*(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac)) + plane_b*(sin(fic)*cos(kac)*cos(omc) - sin(kac)*sin(omc))*cos(om_mirror) + plane_c*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc))*sin(om_mirror)))/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + (-ray_dir_y + (plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror)))*(2*ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + 2*ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + 2*ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))))*((1.0/2.0)*pow(plane_d, 2)*pow(ray_dir_x, 2)*(-2*ray_dir_x*(-plane_a*sin(kac)*cos(fic) - plane_b*cos(fic)*cos(kac)*cos(om_mirror) + plane_c*sin(om_mirror)*cos(fic)*cos(kac)) - 2*ray_dir_y*(plane_a*(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc)) + plane_b*(-sin(fic)*sin(omc)*cos(kac) - sin(kac)*cos(omc))*cos(om_mirror) + plane_c*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc))*sin(om_mirror)) - 2*ray_dir_z*(plane_a*(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac)) + plane_b*(sin(fic)*cos(kac)*cos(omc) - sin(kac)*sin(omc))*cos(om_mirror) + plane_c*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc))*sin(om_mirror)))/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 3) + (1.0/2.0)*pow(plane_d, 2)*pow(ray_dir_y, 2)*(-2*ray_dir_x*(-plane_a*sin(kac)*cos(fic) - plane_b*cos(fic)*cos(kac)*cos(om_mirror) + plane_c*sin(om_mirror)*cos(fic)*cos(kac)) - 2*ray_dir_y*(plane_a*(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc)) + plane_b*(-sin(fic)*sin(omc)*cos(kac) - sin(kac)*cos(omc))*cos(om_mirror) + plane_c*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc))*sin(om_mirror)) - 2*ray_dir_z*(plane_a*(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac)) + plane_b*(sin(fic)*cos(kac)*cos(omc) - sin(kac)*sin(omc))*cos(om_mirror) + plane_c*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc))*sin(om_mirror)))/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 3) + (1.0/2.0)*pow(plane_d, 2)*pow(ray_dir_z, 2)*(-2*ray_dir_x*(-plane_a*sin(kac)*cos(fic) - plane_b*cos(fic)*cos(kac)*cos(om_mirror) + plane_c*sin(om_mirror)*cos(fic)*cos(kac)) - 2*ray_dir_y*(plane_a*(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc)) + plane_b*(-sin(fic)*sin(omc)*cos(kac) - sin(kac)*cos(omc))*cos(om_mirror) + plane_c*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc))*sin(om_mirror)) - 2*ray_dir_z*(plane_a*(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac)) + plane_b*(sin(fic)*cos(kac)*cos(omc) - sin(kac)*sin(omc))*cos(om_mirror) + plane_c*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc))*sin(om_mirror)))/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 3))/sqrt(pow(plane_d, 2)*pow(ray_dir_x, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_y, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_z, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2)) + (-ray_length + sqrt(pow(plane_d, 2)*pow(ray_dir_x, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_y, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_z, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2)))*((plane_a*(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc)) + plane_b*(-sin(fic)*sin(omc)*cos(kac) - sin(kac)*cos(omc))*cos(om_mirror) + plane_c*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc))*sin(om_mirror))*(2*ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + 2*ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + 2*ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))) + (plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror)))*(2*ray_dir_x*(-plane_a*sin(kac)*cos(fic) - plane_b*cos(fic)*cos(kac)*cos(om_mirror) + plane_c*sin(om_mirror)*cos(fic)*cos(kac)) + 2*ray_dir_y*(plane_a*(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc)) + plane_b*(-sin(fic)*sin(omc)*cos(kac) - sin(kac)*cos(omc))*cos(om_mirror) + plane_c*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc))*sin(om_mirror)) + 2*ray_dir_z*(plane_a*(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac)) + plane_b*(sin(fic)*cos(kac)*cos(omc) - sin(kac)*sin(omc))*cos(om_mirror) + plane_c*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc))*sin(om_mirror)))))*sin(ka)*cos(fi);
j.coeffRef(1,0) = 0;
j.coeffRef(1,1) = -1;
j.coeffRef(1,2) = 0;
j.coeffRef(1,3) = (plane_d*ray_dir_x/(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))) - (-ray_dir_x + (2*ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + 2*ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + 2*ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))))*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))))*(ray_length - sqrt(pow(plane_d, 2)*pow(ray_dir_x, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_y, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_z, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2))))*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + (plane_d*ray_dir_y/(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))) - (-ray_dir_y + (plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror)))*(2*ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + 2*ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + 2*ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))))*(ray_length - sqrt(pow(plane_d, 2)*pow(ray_dir_x, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_y, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_z, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2))))*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + (plane_d*ray_dir_y/(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))) - (-ray_dir_z + (plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))*(2*ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + 2*ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + 2*ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))))*(ray_length - sqrt(pow(plane_d, 2)*pow(ray_dir_x, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_y, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_z, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2))))*cos(fi)*cos(om);
j.coeffRef(1,4) = -(plane_d*ray_dir_x/(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))) - (-ray_dir_x + (2*ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + 2*ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + 2*ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))))*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))))*(ray_length - sqrt(pow(plane_d, 2)*pow(ray_dir_x, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_y, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_z, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2))))*sin(om)*cos(fi)*cos(ka) + (plane_d*ray_dir_y/(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))) - (-ray_dir_y + (plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror)))*(2*ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + 2*ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + 2*ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))))*(ray_length - sqrt(pow(plane_d, 2)*pow(ray_dir_x, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_y, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_z, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2))))*sin(ka)*sin(om)*cos(fi) - (plane_d*ray_dir_y/(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))) - (-ray_dir_z + (plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))*(2*ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + 2*ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + 2*ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))))*(ray_length - sqrt(pow(plane_d, 2)*pow(ray_dir_x, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_y, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_z, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2))))*sin(fi)*sin(om);
j.coeffRef(1,5) = (plane_d*ray_dir_x/(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))) - (-ray_dir_x + (2*ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + 2*ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + 2*ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))))*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))))*(ray_length - sqrt(pow(plane_d, 2)*pow(ray_dir_x, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_y, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_z, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2))))*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + (plane_d*ray_dir_y/(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))) - (-ray_dir_y + (plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror)))*(2*ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + 2*ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + 2*ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))))*(ray_length - sqrt(pow(plane_d, 2)*pow(ray_dir_x, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_y, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_z, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2))))*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om));
j.coeffRef(1,6) = (sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om))*(plane_d*ray_dir_y*(-ray_dir_x*cos(fic)*cos(kac) - ray_dir_y*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) - ray_dir_z*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)))/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + (-ray_dir_y + (plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror)))*(2*ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + 2*ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + 2*ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))))*((1.0/2.0)*pow(plane_d, 2)*pow(ray_dir_x, 2)*(-2*ray_dir_x*cos(fic)*cos(kac) - 2*ray_dir_y*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) - 2*ray_dir_z*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)))/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 3) + (1.0/2.0)*pow(plane_d, 2)*pow(ray_dir_y, 2)*(-2*ray_dir_x*cos(fic)*cos(kac) - 2*ray_dir_y*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) - 2*ray_dir_z*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)))/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 3) + (1.0/2.0)*pow(plane_d, 2)*pow(ray_dir_z, 2)*(-2*ray_dir_x*cos(fic)*cos(kac) - 2*ray_dir_y*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) - 2*ray_dir_z*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)))/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 3))/sqrt(pow(plane_d, 2)*pow(ray_dir_x, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_y, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_z, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2)) + (-ray_length + sqrt(pow(plane_d, 2)*pow(ray_dir_x, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_y, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_z, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2)))*((sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc))*(2*ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + 2*ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + 2*ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))) + (plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror)))*(2*ray_dir_x*cos(fic)*cos(kac) + 2*ray_dir_y*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + 2*ray_dir_z*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc))))) + (-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om))*(plane_d*ray_dir_x*(-ray_dir_x*cos(fic)*cos(kac) - ray_dir_y*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) - ray_dir_z*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)))/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + (-ray_dir_x + (2*ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + 2*ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + 2*ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))))*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))))*((1.0/2.0)*pow(plane_d, 2)*pow(ray_dir_x, 2)*(-2*ray_dir_x*cos(fic)*cos(kac) - 2*ray_dir_y*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) - 2*ray_dir_z*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)))/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 3) + (1.0/2.0)*pow(plane_d, 2)*pow(ray_dir_y, 2)*(-2*ray_dir_x*cos(fic)*cos(kac) - 2*ray_dir_y*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) - 2*ray_dir_z*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)))/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 3) + (1.0/2.0)*pow(plane_d, 2)*pow(ray_dir_z, 2)*(-2*ray_dir_x*cos(fic)*cos(kac) - 2*ray_dir_y*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) - 2*ray_dir_z*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)))/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 3))/sqrt(pow(plane_d, 2)*pow(ray_dir_x, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_y, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_z, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2)) + (-ray_length + sqrt(pow(plane_d, 2)*pow(ray_dir_x, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_y, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_z, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2)))*((2*ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + 2*ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + 2*ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))))*cos(fic)*cos(kac) + (plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic)))*(2*ray_dir_x*cos(fic)*cos(kac) + 2*ray_dir_y*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + 2*ray_dir_z*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc))))) + (plane_d*ray_dir_y*(-ray_dir_x*cos(fic)*cos(kac) - ray_dir_y*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) - ray_dir_z*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)))/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + (-ray_dir_z + (plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))*(2*ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + 2*ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + 2*ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))))*((1.0/2.0)*pow(plane_d, 2)*pow(ray_dir_x, 2)*(-2*ray_dir_x*cos(fic)*cos(kac) - 2*ray_dir_y*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) - 2*ray_dir_z*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)))/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 3) + (1.0/2.0)*pow(plane_d, 2)*pow(ray_dir_y, 2)*(-2*ray_dir_x*cos(fic)*cos(kac) - 2*ray_dir_y*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) - 2*ray_dir_z*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)))/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 3) + (1.0/2.0)*pow(plane_d, 2)*pow(ray_dir_z, 2)*(-2*ray_dir_x*cos(fic)*cos(kac) - 2*ray_dir_y*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) - 2*ray_dir_z*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)))/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 3))/sqrt(pow(plane_d, 2)*pow(ray_dir_x, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_y, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_z, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2)) + (-ray_length + sqrt(pow(plane_d, 2)*pow(ray_dir_x, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_y, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_z, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2)))*((-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc))*(2*ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + 2*ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + 2*ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))) + (plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))*(2*ray_dir_x*cos(fic)*cos(kac) + 2*ray_dir_y*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + 2*ray_dir_z*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)))))*sin(om)*cos(fi);
j.coeffRef(1,7) = (sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om))*(plane_d*ray_dir_y*(-ray_dir_x*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) - ray_dir_y*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) - ray_dir_z*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)))/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + (-ray_dir_y + (plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror)))*(2*ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + 2*ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + 2*ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))))*((1.0/2.0)*pow(plane_d, 2)*pow(ray_dir_x, 2)*(-2*ray_dir_x*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) - 2*ray_dir_y*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) - 2*ray_dir_z*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)))/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 3) + (1.0/2.0)*pow(plane_d, 2)*pow(ray_dir_y, 2)*(-2*ray_dir_x*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) - 2*ray_dir_y*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) - 2*ray_dir_z*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)))/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 3) + (1.0/2.0)*pow(plane_d, 2)*pow(ray_dir_z, 2)*(-2*ray_dir_x*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) - 2*ray_dir_y*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) - 2*ray_dir_z*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)))/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 3))/sqrt(pow(plane_d, 2)*pow(ray_dir_x, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_y, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_z, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2)) + (-ray_length + sqrt(pow(plane_d, 2)*pow(ray_dir_x, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_y, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_z, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2)))*(((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic))*(2*ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + 2*ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + 2*ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))) + (plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror)))*(2*ray_dir_x*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + 2*ray_dir_y*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + 2*ray_dir_z*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc))))) + (-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om))*(plane_d*ray_dir_x*(-ray_dir_x*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) - ray_dir_y*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) - ray_dir_z*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)))/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + (-ray_dir_x + (2*ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + 2*ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + 2*ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))))*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))))*((1.0/2.0)*pow(plane_d, 2)*pow(ray_dir_x, 2)*(-2*ray_dir_x*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) - 2*ray_dir_y*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) - 2*ray_dir_z*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)))/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 3) + (1.0/2.0)*pow(plane_d, 2)*pow(ray_dir_y, 2)*(-2*ray_dir_x*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) - 2*ray_dir_y*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) - 2*ray_dir_z*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)))/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 3) + (1.0/2.0)*pow(plane_d, 2)*pow(ray_dir_z, 2)*(-2*ray_dir_x*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) - 2*ray_dir_y*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) - 2*ray_dir_z*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)))/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 3))/sqrt(pow(plane_d, 2)*pow(ray_dir_x, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_y, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_z, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2)) + (-ray_length + sqrt(pow(plane_d, 2)*pow(ray_dir_x, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_y, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_z, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2)))*((sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror))*(2*ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + 2*ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + 2*ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))) + (2*ray_dir_x*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + 2*ray_dir_y*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + 2*ray_dir_z*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)))*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))))) + (plane_d*ray_dir_y*(-ray_dir_x*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) - ray_dir_y*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) - ray_dir_z*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)))/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + (-ray_dir_z + (plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))*(2*ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + 2*ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + 2*ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))))*((1.0/2.0)*pow(plane_d, 2)*pow(ray_dir_x, 2)*(-2*ray_dir_x*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) - 2*ray_dir_y*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) - 2*ray_dir_z*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)))/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 3) + (1.0/2.0)*pow(plane_d, 2)*pow(ray_dir_y, 2)*(-2*ray_dir_x*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) - 2*ray_dir_y*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) - 2*ray_dir_z*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)))/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 3) + (1.0/2.0)*pow(plane_d, 2)*pow(ray_dir_z, 2)*(-2*ray_dir_x*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) - 2*ray_dir_y*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) - 2*ray_dir_z*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)))/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 3))/sqrt(pow(plane_d, 2)*pow(ray_dir_x, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_y, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_z, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2)) + (-ray_length + sqrt(pow(plane_d, 2)*pow(ray_dir_x, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_y, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_z, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2)))*(((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc))*(2*ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + 2*ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + 2*ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))) + (plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))*(2*ray_dir_x*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + 2*ray_dir_y*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + 2*ray_dir_z*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)))))*sin(om)*cos(fi);
j.coeffRef(1,8) = (sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om))*(plane_d*ray_dir_y*(-ray_dir_x*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic)) - ray_dir_y*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror)) - ray_dir_z*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + (-ray_dir_y + (plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror)))*(2*ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + 2*ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + 2*ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))))*((1.0/2.0)*pow(plane_d, 2)*pow(ray_dir_x, 2)*(-2*ray_dir_x*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic)) - 2*ray_dir_y*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror)) - 2*ray_dir_z*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 3) + (1.0/2.0)*pow(plane_d, 2)*pow(ray_dir_y, 2)*(-2*ray_dir_x*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic)) - 2*ray_dir_y*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror)) - 2*ray_dir_z*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 3) + (1.0/2.0)*pow(plane_d, 2)*pow(ray_dir_z, 2)*(-2*ray_dir_x*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic)) - 2*ray_dir_y*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror)) - 2*ray_dir_z*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 3))/sqrt(pow(plane_d, 2)*pow(ray_dir_x, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_y, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_z, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2)) + (-ray_length + sqrt(pow(plane_d, 2)*pow(ray_dir_x, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_y, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_z, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2)))*((-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))*(2*ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + 2*ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + 2*ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))) + (plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror)))*(2*ray_dir_x*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic)) + 2*ray_dir_y*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror)) + 2*ray_dir_z*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))))) + (-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om))*(plane_d*ray_dir_x*(-ray_dir_x*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic)) - ray_dir_y*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror)) - ray_dir_z*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + (-ray_dir_x + (2*ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + 2*ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + 2*ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))))*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))))*((1.0/2.0)*pow(plane_d, 2)*pow(ray_dir_x, 2)*(-2*ray_dir_x*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic)) - 2*ray_dir_y*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror)) - 2*ray_dir_z*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 3) + (1.0/2.0)*pow(plane_d, 2)*pow(ray_dir_y, 2)*(-2*ray_dir_x*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic)) - 2*ray_dir_y*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror)) - 2*ray_dir_z*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 3) + (1.0/2.0)*pow(plane_d, 2)*pow(ray_dir_z, 2)*(-2*ray_dir_x*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic)) - 2*ray_dir_y*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror)) - 2*ray_dir_z*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 3))/sqrt(pow(plane_d, 2)*pow(ray_dir_x, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_y, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_z, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2)) + (-ray_length + sqrt(pow(plane_d, 2)*pow(ray_dir_x, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_y, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_z, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2)))*((sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))*(2*ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + 2*ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + 2*ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))) + (2*ray_dir_x*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic)) + 2*ray_dir_y*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror)) + 2*ray_dir_z*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))))) + (plane_d*ray_dir_y*(-ray_dir_x*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic)) - ray_dir_y*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror)) - ray_dir_z*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + (-ray_dir_z + (plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))*(2*ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + 2*ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + 2*ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))))*((1.0/2.0)*pow(plane_d, 2)*pow(ray_dir_x, 2)*(-2*ray_dir_x*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic)) - 2*ray_dir_y*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror)) - 2*ray_dir_z*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 3) + (1.0/2.0)*pow(plane_d, 2)*pow(ray_dir_y, 2)*(-2*ray_dir_x*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic)) - 2*ray_dir_y*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror)) - 2*ray_dir_z*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 3) + (1.0/2.0)*pow(plane_d, 2)*pow(ray_dir_z, 2)*(-2*ray_dir_x*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic)) - 2*ray_dir_y*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror)) - 2*ray_dir_z*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 3))/sqrt(pow(plane_d, 2)*pow(ray_dir_x, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_y, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_z, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2)) + (-ray_length + sqrt(pow(plane_d, 2)*pow(ray_dir_x, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_y, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_z, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2)))*((-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))*(2*ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + 2*ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + 2*ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))) + (plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))*(2*ray_dir_x*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic)) + 2*ray_dir_y*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror)) + 2*ray_dir_z*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))))*sin(om)*cos(fi);
j.coeffRef(1,9) = (ray_dir_x/(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))) + (-ray_dir_x + (2*ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + 2*ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + 2*ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))))*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))))*(plane_d*pow(ray_dir_x, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + plane_d*pow(ray_dir_y, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + plane_d*pow(ray_dir_z, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2))/sqrt(pow(plane_d, 2)*pow(ray_dir_x, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_y, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_z, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2)))*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + (ray_dir_y/(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))) + (-ray_dir_y + (plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror)))*(2*ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + 2*ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + 2*ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))))*(plane_d*pow(ray_dir_x, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + plane_d*pow(ray_dir_y, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + plane_d*pow(ray_dir_z, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2))/sqrt(pow(plane_d, 2)*pow(ray_dir_x, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_y, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_z, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2)))*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + (ray_dir_y/(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))) + (-ray_dir_z + (plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))*(2*ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + 2*ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + 2*ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))))*(plane_d*pow(ray_dir_x, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + plane_d*pow(ray_dir_y, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + plane_d*pow(ray_dir_z, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2))/sqrt(pow(plane_d, 2)*pow(ray_dir_x, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_y, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_z, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2)))*sin(om)*cos(fi);
j.coeffRef(1,10) = 0;
j.coeffRef(1,11) = 0;
j.coeffRef(1,12) = (sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om))*(plane_d*ray_dir_y*(-ray_dir_x*(-plane_a*sin(fic)*cos(kac) + plane_b*(sin(fic)*sin(kac)*cos(om_mirror) + sin(om_mirror)*cos(fic)) + plane_c*(-sin(fic)*sin(kac)*sin(om_mirror) + cos(fic)*cos(om_mirror))) - ray_dir_y*(plane_a*sin(omc)*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror)*sin(omc) - sin(kac)*sin(omc)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*sin(omc)*cos(om_mirror) + sin(kac)*sin(om_mirror)*sin(omc)*cos(fic))) - ray_dir_z*(-plane_a*cos(fic)*cos(kac)*cos(omc) + plane_b*(-sin(fic)*sin(om_mirror)*cos(omc) + sin(kac)*cos(fic)*cos(om_mirror)*cos(omc)) + plane_c*(-sin(fic)*cos(om_mirror)*cos(omc) - sin(kac)*sin(om_mirror)*cos(fic)*cos(omc))))/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + (-ray_dir_y + (plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror)))*(2*ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + 2*ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + 2*ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))))*((1.0/2.0)*pow(plane_d, 2)*pow(ray_dir_x, 2)*(-2*ray_dir_x*(-plane_a*sin(fic)*cos(kac) + plane_b*(sin(fic)*sin(kac)*cos(om_mirror) + sin(om_mirror)*cos(fic)) + plane_c*(-sin(fic)*sin(kac)*sin(om_mirror) + cos(fic)*cos(om_mirror))) - 2*ray_dir_y*(plane_a*sin(omc)*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror)*sin(omc) - sin(kac)*sin(omc)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*sin(omc)*cos(om_mirror) + sin(kac)*sin(om_mirror)*sin(omc)*cos(fic))) - 2*ray_dir_z*(-plane_a*cos(fic)*cos(kac)*cos(omc) + plane_b*(-sin(fic)*sin(om_mirror)*cos(omc) + sin(kac)*cos(fic)*cos(om_mirror)*cos(omc)) + plane_c*(-sin(fic)*cos(om_mirror)*cos(omc) - sin(kac)*sin(om_mirror)*cos(fic)*cos(omc))))/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 3) + (1.0/2.0)*pow(plane_d, 2)*pow(ray_dir_y, 2)*(-2*ray_dir_x*(-plane_a*sin(fic)*cos(kac) + plane_b*(sin(fic)*sin(kac)*cos(om_mirror) + sin(om_mirror)*cos(fic)) + plane_c*(-sin(fic)*sin(kac)*sin(om_mirror) + cos(fic)*cos(om_mirror))) - 2*ray_dir_y*(plane_a*sin(omc)*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror)*sin(omc) - sin(kac)*sin(omc)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*sin(omc)*cos(om_mirror) + sin(kac)*sin(om_mirror)*sin(omc)*cos(fic))) - 2*ray_dir_z*(-plane_a*cos(fic)*cos(kac)*cos(omc) + plane_b*(-sin(fic)*sin(om_mirror)*cos(omc) + sin(kac)*cos(fic)*cos(om_mirror)*cos(omc)) + plane_c*(-sin(fic)*cos(om_mirror)*cos(omc) - sin(kac)*sin(om_mirror)*cos(fic)*cos(omc))))/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 3) + (1.0/2.0)*pow(plane_d, 2)*pow(ray_dir_z, 2)*(-2*ray_dir_x*(-plane_a*sin(fic)*cos(kac) + plane_b*(sin(fic)*sin(kac)*cos(om_mirror) + sin(om_mirror)*cos(fic)) + plane_c*(-sin(fic)*sin(kac)*sin(om_mirror) + cos(fic)*cos(om_mirror))) - 2*ray_dir_y*(plane_a*sin(omc)*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror)*sin(omc) - sin(kac)*sin(omc)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*sin(omc)*cos(om_mirror) + sin(kac)*sin(om_mirror)*sin(omc)*cos(fic))) - 2*ray_dir_z*(-plane_a*cos(fic)*cos(kac)*cos(omc) + plane_b*(-sin(fic)*sin(om_mirror)*cos(omc) + sin(kac)*cos(fic)*cos(om_mirror)*cos(omc)) + plane_c*(-sin(fic)*cos(om_mirror)*cos(omc) - sin(kac)*sin(om_mirror)*cos(fic)*cos(omc))))/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 3))/sqrt(pow(plane_d, 2)*pow(ray_dir_x, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_y, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_z, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2)) + (-ray_length + sqrt(pow(plane_d, 2)*pow(ray_dir_x, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_y, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_z, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2)))*((plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror)))*(2*ray_dir_x*(-plane_a*sin(fic)*cos(kac) + plane_b*(sin(fic)*sin(kac)*cos(om_mirror) + sin(om_mirror)*cos(fic)) + plane_c*(-sin(fic)*sin(kac)*sin(om_mirror) + cos(fic)*cos(om_mirror))) + 2*ray_dir_y*(plane_a*sin(omc)*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror)*sin(omc) - sin(kac)*sin(omc)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*sin(omc)*cos(om_mirror) + sin(kac)*sin(om_mirror)*sin(omc)*cos(fic))) + 2*ray_dir_z*(-plane_a*cos(fic)*cos(kac)*cos(omc) + plane_b*(-sin(fic)*sin(om_mirror)*cos(omc) + sin(kac)*cos(fic)*cos(om_mirror)*cos(omc)) + plane_c*(-sin(fic)*cos(om_mirror)*cos(omc) - sin(kac)*sin(om_mirror)*cos(fic)*cos(omc)))) + (2*ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + 2*ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + 2*ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))))*(plane_a*sin(omc)*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror)*sin(omc) - sin(kac)*sin(omc)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*sin(omc)*cos(om_mirror) + sin(kac)*sin(om_mirror)*sin(omc)*cos(fic))))) + (-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om))*(plane_d*ray_dir_x*(-ray_dir_x*(-plane_a*sin(fic)*cos(kac) + plane_b*(sin(fic)*sin(kac)*cos(om_mirror) + sin(om_mirror)*cos(fic)) + plane_c*(-sin(fic)*sin(kac)*sin(om_mirror) + cos(fic)*cos(om_mirror))) - ray_dir_y*(plane_a*sin(omc)*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror)*sin(omc) - sin(kac)*sin(omc)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*sin(omc)*cos(om_mirror) + sin(kac)*sin(om_mirror)*sin(omc)*cos(fic))) - ray_dir_z*(-plane_a*cos(fic)*cos(kac)*cos(omc) + plane_b*(-sin(fic)*sin(om_mirror)*cos(omc) + sin(kac)*cos(fic)*cos(om_mirror)*cos(omc)) + plane_c*(-sin(fic)*cos(om_mirror)*cos(omc) - sin(kac)*sin(om_mirror)*cos(fic)*cos(omc))))/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + (-ray_dir_x + (2*ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + 2*ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + 2*ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))))*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))))*((1.0/2.0)*pow(plane_d, 2)*pow(ray_dir_x, 2)*(-2*ray_dir_x*(-plane_a*sin(fic)*cos(kac) + plane_b*(sin(fic)*sin(kac)*cos(om_mirror) + sin(om_mirror)*cos(fic)) + plane_c*(-sin(fic)*sin(kac)*sin(om_mirror) + cos(fic)*cos(om_mirror))) - 2*ray_dir_y*(plane_a*sin(omc)*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror)*sin(omc) - sin(kac)*sin(omc)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*sin(omc)*cos(om_mirror) + sin(kac)*sin(om_mirror)*sin(omc)*cos(fic))) - 2*ray_dir_z*(-plane_a*cos(fic)*cos(kac)*cos(omc) + plane_b*(-sin(fic)*sin(om_mirror)*cos(omc) + sin(kac)*cos(fic)*cos(om_mirror)*cos(omc)) + plane_c*(-sin(fic)*cos(om_mirror)*cos(omc) - sin(kac)*sin(om_mirror)*cos(fic)*cos(omc))))/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 3) + (1.0/2.0)*pow(plane_d, 2)*pow(ray_dir_y, 2)*(-2*ray_dir_x*(-plane_a*sin(fic)*cos(kac) + plane_b*(sin(fic)*sin(kac)*cos(om_mirror) + sin(om_mirror)*cos(fic)) + plane_c*(-sin(fic)*sin(kac)*sin(om_mirror) + cos(fic)*cos(om_mirror))) - 2*ray_dir_y*(plane_a*sin(omc)*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror)*sin(omc) - sin(kac)*sin(omc)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*sin(omc)*cos(om_mirror) + sin(kac)*sin(om_mirror)*sin(omc)*cos(fic))) - 2*ray_dir_z*(-plane_a*cos(fic)*cos(kac)*cos(omc) + plane_b*(-sin(fic)*sin(om_mirror)*cos(omc) + sin(kac)*cos(fic)*cos(om_mirror)*cos(omc)) + plane_c*(-sin(fic)*cos(om_mirror)*cos(omc) - sin(kac)*sin(om_mirror)*cos(fic)*cos(omc))))/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 3) + (1.0/2.0)*pow(plane_d, 2)*pow(ray_dir_z, 2)*(-2*ray_dir_x*(-plane_a*sin(fic)*cos(kac) + plane_b*(sin(fic)*sin(kac)*cos(om_mirror) + sin(om_mirror)*cos(fic)) + plane_c*(-sin(fic)*sin(kac)*sin(om_mirror) + cos(fic)*cos(om_mirror))) - 2*ray_dir_y*(plane_a*sin(omc)*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror)*sin(omc) - sin(kac)*sin(omc)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*sin(omc)*cos(om_mirror) + sin(kac)*sin(om_mirror)*sin(omc)*cos(fic))) - 2*ray_dir_z*(-plane_a*cos(fic)*cos(kac)*cos(omc) + plane_b*(-sin(fic)*sin(om_mirror)*cos(omc) + sin(kac)*cos(fic)*cos(om_mirror)*cos(omc)) + plane_c*(-sin(fic)*cos(om_mirror)*cos(omc) - sin(kac)*sin(om_mirror)*cos(fic)*cos(omc))))/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 3))/sqrt(pow(plane_d, 2)*pow(ray_dir_x, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_y, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_z, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2)) + (-ray_length + sqrt(pow(plane_d, 2)*pow(ray_dir_x, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_y, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_z, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2)))*((2*ray_dir_x*(-plane_a*sin(fic)*cos(kac) + plane_b*(sin(fic)*sin(kac)*cos(om_mirror) + sin(om_mirror)*cos(fic)) + plane_c*(-sin(fic)*sin(kac)*sin(om_mirror) + cos(fic)*cos(om_mirror))) + 2*ray_dir_y*(plane_a*sin(omc)*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror)*sin(omc) - sin(kac)*sin(omc)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*sin(omc)*cos(om_mirror) + sin(kac)*sin(om_mirror)*sin(omc)*cos(fic))) + 2*ray_dir_z*(-plane_a*cos(fic)*cos(kac)*cos(omc) + plane_b*(-sin(fic)*sin(om_mirror)*cos(omc) + sin(kac)*cos(fic)*cos(om_mirror)*cos(omc)) + plane_c*(-sin(fic)*cos(om_mirror)*cos(omc) - sin(kac)*sin(om_mirror)*cos(fic)*cos(omc))))*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + (2*ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + 2*ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + 2*ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))))*(-plane_a*sin(fic)*cos(kac) + plane_b*(sin(fic)*sin(kac)*cos(om_mirror) + sin(om_mirror)*cos(fic)) + plane_c*(-sin(fic)*sin(kac)*sin(om_mirror) + cos(fic)*cos(om_mirror))))) + (plane_d*ray_dir_y*(-ray_dir_x*(-plane_a*sin(fic)*cos(kac) + plane_b*(sin(fic)*sin(kac)*cos(om_mirror) + sin(om_mirror)*cos(fic)) + plane_c*(-sin(fic)*sin(kac)*sin(om_mirror) + cos(fic)*cos(om_mirror))) - ray_dir_y*(plane_a*sin(omc)*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror)*sin(omc) - sin(kac)*sin(omc)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*sin(omc)*cos(om_mirror) + sin(kac)*sin(om_mirror)*sin(omc)*cos(fic))) - ray_dir_z*(-plane_a*cos(fic)*cos(kac)*cos(omc) + plane_b*(-sin(fic)*sin(om_mirror)*cos(omc) + sin(kac)*cos(fic)*cos(om_mirror)*cos(omc)) + plane_c*(-sin(fic)*cos(om_mirror)*cos(omc) - sin(kac)*sin(om_mirror)*cos(fic)*cos(omc))))/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + (-ray_dir_z + (plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))*(2*ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + 2*ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + 2*ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))))*((1.0/2.0)*pow(plane_d, 2)*pow(ray_dir_x, 2)*(-2*ray_dir_x*(-plane_a*sin(fic)*cos(kac) + plane_b*(sin(fic)*sin(kac)*cos(om_mirror) + sin(om_mirror)*cos(fic)) + plane_c*(-sin(fic)*sin(kac)*sin(om_mirror) + cos(fic)*cos(om_mirror))) - 2*ray_dir_y*(plane_a*sin(omc)*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror)*sin(omc) - sin(kac)*sin(omc)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*sin(omc)*cos(om_mirror) + sin(kac)*sin(om_mirror)*sin(omc)*cos(fic))) - 2*ray_dir_z*(-plane_a*cos(fic)*cos(kac)*cos(omc) + plane_b*(-sin(fic)*sin(om_mirror)*cos(omc) + sin(kac)*cos(fic)*cos(om_mirror)*cos(omc)) + plane_c*(-sin(fic)*cos(om_mirror)*cos(omc) - sin(kac)*sin(om_mirror)*cos(fic)*cos(omc))))/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 3) + (1.0/2.0)*pow(plane_d, 2)*pow(ray_dir_y, 2)*(-2*ray_dir_x*(-plane_a*sin(fic)*cos(kac) + plane_b*(sin(fic)*sin(kac)*cos(om_mirror) + sin(om_mirror)*cos(fic)) + plane_c*(-sin(fic)*sin(kac)*sin(om_mirror) + cos(fic)*cos(om_mirror))) - 2*ray_dir_y*(plane_a*sin(omc)*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror)*sin(omc) - sin(kac)*sin(omc)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*sin(omc)*cos(om_mirror) + sin(kac)*sin(om_mirror)*sin(omc)*cos(fic))) - 2*ray_dir_z*(-plane_a*cos(fic)*cos(kac)*cos(omc) + plane_b*(-sin(fic)*sin(om_mirror)*cos(omc) + sin(kac)*cos(fic)*cos(om_mirror)*cos(omc)) + plane_c*(-sin(fic)*cos(om_mirror)*cos(omc) - sin(kac)*sin(om_mirror)*cos(fic)*cos(omc))))/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 3) + (1.0/2.0)*pow(plane_d, 2)*pow(ray_dir_z, 2)*(-2*ray_dir_x*(-plane_a*sin(fic)*cos(kac) + plane_b*(sin(fic)*sin(kac)*cos(om_mirror) + sin(om_mirror)*cos(fic)) + plane_c*(-sin(fic)*sin(kac)*sin(om_mirror) + cos(fic)*cos(om_mirror))) - 2*ray_dir_y*(plane_a*sin(omc)*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror)*sin(omc) - sin(kac)*sin(omc)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*sin(omc)*cos(om_mirror) + sin(kac)*sin(om_mirror)*sin(omc)*cos(fic))) - 2*ray_dir_z*(-plane_a*cos(fic)*cos(kac)*cos(omc) + plane_b*(-sin(fic)*sin(om_mirror)*cos(omc) + sin(kac)*cos(fic)*cos(om_mirror)*cos(omc)) + plane_c*(-sin(fic)*cos(om_mirror)*cos(omc) - sin(kac)*sin(om_mirror)*cos(fic)*cos(omc))))/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 3))/sqrt(pow(plane_d, 2)*pow(ray_dir_x, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_y, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_z, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2)) + (-ray_length + sqrt(pow(plane_d, 2)*pow(ray_dir_x, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_y, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_z, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2)))*((plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))*(2*ray_dir_x*(-plane_a*sin(fic)*cos(kac) + plane_b*(sin(fic)*sin(kac)*cos(om_mirror) + sin(om_mirror)*cos(fic)) + plane_c*(-sin(fic)*sin(kac)*sin(om_mirror) + cos(fic)*cos(om_mirror))) + 2*ray_dir_y*(plane_a*sin(omc)*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror)*sin(omc) - sin(kac)*sin(omc)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*sin(omc)*cos(om_mirror) + sin(kac)*sin(om_mirror)*sin(omc)*cos(fic))) + 2*ray_dir_z*(-plane_a*cos(fic)*cos(kac)*cos(omc) + plane_b*(-sin(fic)*sin(om_mirror)*cos(omc) + sin(kac)*cos(fic)*cos(om_mirror)*cos(omc)) + plane_c*(-sin(fic)*cos(om_mirror)*cos(omc) - sin(kac)*sin(om_mirror)*cos(fic)*cos(omc)))) + (2*ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + 2*ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + 2*ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))))*(-plane_a*cos(fic)*cos(kac)*cos(omc) + plane_b*(-sin(fic)*sin(om_mirror)*cos(omc) + sin(kac)*cos(fic)*cos(om_mirror)*cos(omc)) + plane_c*(-sin(fic)*cos(om_mirror)*cos(omc) - sin(kac)*sin(om_mirror)*cos(fic)*cos(omc)))))*sin(om)*cos(fi);
j.coeffRef(1,13) = (sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om))*(plane_d*ray_dir_y*(-ray_dir_x*(-plane_a*sin(kac)*cos(fic) - plane_b*cos(fic)*cos(kac)*cos(om_mirror) + plane_c*sin(om_mirror)*cos(fic)*cos(kac)) - ray_dir_y*(plane_a*(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc)) + plane_b*(-sin(fic)*sin(omc)*cos(kac) - sin(kac)*cos(omc))*cos(om_mirror) + plane_c*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc))*sin(om_mirror)) - ray_dir_z*(plane_a*(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac)) + plane_b*(sin(fic)*cos(kac)*cos(omc) - sin(kac)*sin(omc))*cos(om_mirror) + plane_c*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc))*sin(om_mirror)))/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + (-ray_dir_y + (plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror)))*(2*ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + 2*ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + 2*ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))))*((1.0/2.0)*pow(plane_d, 2)*pow(ray_dir_x, 2)*(-2*ray_dir_x*(-plane_a*sin(kac)*cos(fic) - plane_b*cos(fic)*cos(kac)*cos(om_mirror) + plane_c*sin(om_mirror)*cos(fic)*cos(kac)) - 2*ray_dir_y*(plane_a*(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc)) + plane_b*(-sin(fic)*sin(omc)*cos(kac) - sin(kac)*cos(omc))*cos(om_mirror) + plane_c*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc))*sin(om_mirror)) - 2*ray_dir_z*(plane_a*(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac)) + plane_b*(sin(fic)*cos(kac)*cos(omc) - sin(kac)*sin(omc))*cos(om_mirror) + plane_c*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc))*sin(om_mirror)))/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 3) + (1.0/2.0)*pow(plane_d, 2)*pow(ray_dir_y, 2)*(-2*ray_dir_x*(-plane_a*sin(kac)*cos(fic) - plane_b*cos(fic)*cos(kac)*cos(om_mirror) + plane_c*sin(om_mirror)*cos(fic)*cos(kac)) - 2*ray_dir_y*(plane_a*(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc)) + plane_b*(-sin(fic)*sin(omc)*cos(kac) - sin(kac)*cos(omc))*cos(om_mirror) + plane_c*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc))*sin(om_mirror)) - 2*ray_dir_z*(plane_a*(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac)) + plane_b*(sin(fic)*cos(kac)*cos(omc) - sin(kac)*sin(omc))*cos(om_mirror) + plane_c*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc))*sin(om_mirror)))/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 3) + (1.0/2.0)*pow(plane_d, 2)*pow(ray_dir_z, 2)*(-2*ray_dir_x*(-plane_a*sin(kac)*cos(fic) - plane_b*cos(fic)*cos(kac)*cos(om_mirror) + plane_c*sin(om_mirror)*cos(fic)*cos(kac)) - 2*ray_dir_y*(plane_a*(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc)) + plane_b*(-sin(fic)*sin(omc)*cos(kac) - sin(kac)*cos(omc))*cos(om_mirror) + plane_c*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc))*sin(om_mirror)) - 2*ray_dir_z*(plane_a*(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac)) + plane_b*(sin(fic)*cos(kac)*cos(omc) - sin(kac)*sin(omc))*cos(om_mirror) + plane_c*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc))*sin(om_mirror)))/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 3))/sqrt(pow(plane_d, 2)*pow(ray_dir_x, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_y, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_z, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2)) + (-ray_length + sqrt(pow(plane_d, 2)*pow(ray_dir_x, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_y, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_z, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2)))*((plane_a*(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc)) + plane_b*(-sin(fic)*sin(omc)*cos(kac) - sin(kac)*cos(omc))*cos(om_mirror) + plane_c*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc))*sin(om_mirror))*(2*ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + 2*ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + 2*ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))) + (plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror)))*(2*ray_dir_x*(-plane_a*sin(kac)*cos(fic) - plane_b*cos(fic)*cos(kac)*cos(om_mirror) + plane_c*sin(om_mirror)*cos(fic)*cos(kac)) + 2*ray_dir_y*(plane_a*(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc)) + plane_b*(-sin(fic)*sin(omc)*cos(kac) - sin(kac)*cos(omc))*cos(om_mirror) + plane_c*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc))*sin(om_mirror)) + 2*ray_dir_z*(plane_a*(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac)) + plane_b*(sin(fic)*cos(kac)*cos(omc) - sin(kac)*sin(omc))*cos(om_mirror) + plane_c*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc))*sin(om_mirror))))) + (-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om))*(plane_d*ray_dir_x*(-ray_dir_x*(-plane_a*sin(kac)*cos(fic) - plane_b*cos(fic)*cos(kac)*cos(om_mirror) + plane_c*sin(om_mirror)*cos(fic)*cos(kac)) - ray_dir_y*(plane_a*(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc)) + plane_b*(-sin(fic)*sin(omc)*cos(kac) - sin(kac)*cos(omc))*cos(om_mirror) + plane_c*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc))*sin(om_mirror)) - ray_dir_z*(plane_a*(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac)) + plane_b*(sin(fic)*cos(kac)*cos(omc) - sin(kac)*sin(omc))*cos(om_mirror) + plane_c*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc))*sin(om_mirror)))/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + (-ray_dir_x + (2*ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + 2*ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + 2*ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))))*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))))*((1.0/2.0)*pow(plane_d, 2)*pow(ray_dir_x, 2)*(-2*ray_dir_x*(-plane_a*sin(kac)*cos(fic) - plane_b*cos(fic)*cos(kac)*cos(om_mirror) + plane_c*sin(om_mirror)*cos(fic)*cos(kac)) - 2*ray_dir_y*(plane_a*(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc)) + plane_b*(-sin(fic)*sin(omc)*cos(kac) - sin(kac)*cos(omc))*cos(om_mirror) + plane_c*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc))*sin(om_mirror)) - 2*ray_dir_z*(plane_a*(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac)) + plane_b*(sin(fic)*cos(kac)*cos(omc) - sin(kac)*sin(omc))*cos(om_mirror) + plane_c*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc))*sin(om_mirror)))/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 3) + (1.0/2.0)*pow(plane_d, 2)*pow(ray_dir_y, 2)*(-2*ray_dir_x*(-plane_a*sin(kac)*cos(fic) - plane_b*cos(fic)*cos(kac)*cos(om_mirror) + plane_c*sin(om_mirror)*cos(fic)*cos(kac)) - 2*ray_dir_y*(plane_a*(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc)) + plane_b*(-sin(fic)*sin(omc)*cos(kac) - sin(kac)*cos(omc))*cos(om_mirror) + plane_c*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc))*sin(om_mirror)) - 2*ray_dir_z*(plane_a*(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac)) + plane_b*(sin(fic)*cos(kac)*cos(omc) - sin(kac)*sin(omc))*cos(om_mirror) + plane_c*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc))*sin(om_mirror)))/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 3) + (1.0/2.0)*pow(plane_d, 2)*pow(ray_dir_z, 2)*(-2*ray_dir_x*(-plane_a*sin(kac)*cos(fic) - plane_b*cos(fic)*cos(kac)*cos(om_mirror) + plane_c*sin(om_mirror)*cos(fic)*cos(kac)) - 2*ray_dir_y*(plane_a*(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc)) + plane_b*(-sin(fic)*sin(omc)*cos(kac) - sin(kac)*cos(omc))*cos(om_mirror) + plane_c*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc))*sin(om_mirror)) - 2*ray_dir_z*(plane_a*(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac)) + plane_b*(sin(fic)*cos(kac)*cos(omc) - sin(kac)*sin(omc))*cos(om_mirror) + plane_c*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc))*sin(om_mirror)))/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 3))/sqrt(pow(plane_d, 2)*pow(ray_dir_x, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_y, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_z, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2)) + (-ray_length + sqrt(pow(plane_d, 2)*pow(ray_dir_x, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_y, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_z, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2)))*((2*ray_dir_x*(-plane_a*sin(kac)*cos(fic) - plane_b*cos(fic)*cos(kac)*cos(om_mirror) + plane_c*sin(om_mirror)*cos(fic)*cos(kac)) + 2*ray_dir_y*(plane_a*(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc)) + plane_b*(-sin(fic)*sin(omc)*cos(kac) - sin(kac)*cos(omc))*cos(om_mirror) + plane_c*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc))*sin(om_mirror)) + 2*ray_dir_z*(plane_a*(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac)) + plane_b*(sin(fic)*cos(kac)*cos(omc) - sin(kac)*sin(omc))*cos(om_mirror) + plane_c*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc))*sin(om_mirror)))*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + (2*ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + 2*ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + 2*ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))))*(-plane_a*sin(kac)*cos(fic) - plane_b*cos(fic)*cos(kac)*cos(om_mirror) + plane_c*sin(om_mirror)*cos(fic)*cos(kac)))) + (plane_d*ray_dir_y*(-ray_dir_x*(-plane_a*sin(kac)*cos(fic) - plane_b*cos(fic)*cos(kac)*cos(om_mirror) + plane_c*sin(om_mirror)*cos(fic)*cos(kac)) - ray_dir_y*(plane_a*(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc)) + plane_b*(-sin(fic)*sin(omc)*cos(kac) - sin(kac)*cos(omc))*cos(om_mirror) + plane_c*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc))*sin(om_mirror)) - ray_dir_z*(plane_a*(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac)) + plane_b*(sin(fic)*cos(kac)*cos(omc) - sin(kac)*sin(omc))*cos(om_mirror) + plane_c*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc))*sin(om_mirror)))/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + (-ray_dir_z + (plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))*(2*ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + 2*ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + 2*ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))))*((1.0/2.0)*pow(plane_d, 2)*pow(ray_dir_x, 2)*(-2*ray_dir_x*(-plane_a*sin(kac)*cos(fic) - plane_b*cos(fic)*cos(kac)*cos(om_mirror) + plane_c*sin(om_mirror)*cos(fic)*cos(kac)) - 2*ray_dir_y*(plane_a*(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc)) + plane_b*(-sin(fic)*sin(omc)*cos(kac) - sin(kac)*cos(omc))*cos(om_mirror) + plane_c*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc))*sin(om_mirror)) - 2*ray_dir_z*(plane_a*(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac)) + plane_b*(sin(fic)*cos(kac)*cos(omc) - sin(kac)*sin(omc))*cos(om_mirror) + plane_c*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc))*sin(om_mirror)))/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 3) + (1.0/2.0)*pow(plane_d, 2)*pow(ray_dir_y, 2)*(-2*ray_dir_x*(-plane_a*sin(kac)*cos(fic) - plane_b*cos(fic)*cos(kac)*cos(om_mirror) + plane_c*sin(om_mirror)*cos(fic)*cos(kac)) - 2*ray_dir_y*(plane_a*(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc)) + plane_b*(-sin(fic)*sin(omc)*cos(kac) - sin(kac)*cos(omc))*cos(om_mirror) + plane_c*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc))*sin(om_mirror)) - 2*ray_dir_z*(plane_a*(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac)) + plane_b*(sin(fic)*cos(kac)*cos(omc) - sin(kac)*sin(omc))*cos(om_mirror) + plane_c*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc))*sin(om_mirror)))/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 3) + (1.0/2.0)*pow(plane_d, 2)*pow(ray_dir_z, 2)*(-2*ray_dir_x*(-plane_a*sin(kac)*cos(fic) - plane_b*cos(fic)*cos(kac)*cos(om_mirror) + plane_c*sin(om_mirror)*cos(fic)*cos(kac)) - 2*ray_dir_y*(plane_a*(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc)) + plane_b*(-sin(fic)*sin(omc)*cos(kac) - sin(kac)*cos(omc))*cos(om_mirror) + plane_c*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc))*sin(om_mirror)) - 2*ray_dir_z*(plane_a*(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac)) + plane_b*(sin(fic)*cos(kac)*cos(omc) - sin(kac)*sin(omc))*cos(om_mirror) + plane_c*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc))*sin(om_mirror)))/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 3))/sqrt(pow(plane_d, 2)*pow(ray_dir_x, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_y, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_z, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2)) + (-ray_length + sqrt(pow(plane_d, 2)*pow(ray_dir_x, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_y, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_z, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2)))*((plane_a*(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac)) + plane_b*(sin(fic)*cos(kac)*cos(omc) - sin(kac)*sin(omc))*cos(om_mirror) + plane_c*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc))*sin(om_mirror))*(2*ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + 2*ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + 2*ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))) + (plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))*(2*ray_dir_x*(-plane_a*sin(kac)*cos(fic) - plane_b*cos(fic)*cos(kac)*cos(om_mirror) + plane_c*sin(om_mirror)*cos(fic)*cos(kac)) + 2*ray_dir_y*(plane_a*(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc)) + plane_b*(-sin(fic)*sin(omc)*cos(kac) - sin(kac)*cos(omc))*cos(om_mirror) + plane_c*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc))*sin(om_mirror)) + 2*ray_dir_z*(plane_a*(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac)) + plane_b*(sin(fic)*cos(kac)*cos(omc) - sin(kac)*sin(omc))*cos(om_mirror) + plane_c*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc))*sin(om_mirror)))))*sin(om)*cos(fi);
j.coeffRef(2,0) = 0;
j.coeffRef(2,1) = 0;
j.coeffRef(2,2) = -1;
j.coeffRef(2,3) = (plane_d*ray_dir_x/(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))) - (-ray_dir_x + (2*ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + 2*ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + 2*ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))))*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))))*(ray_length - sqrt(pow(plane_d, 2)*pow(ray_dir_x, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_y, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_z, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2))))*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) - (-plane_d*ray_dir_y/(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))) + (-ray_dir_z + (plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))*(2*ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + 2*ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + 2*ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))))*(ray_length - sqrt(pow(plane_d, 2)*pow(ray_dir_x, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_y, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_z, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2))))*sin(om)*cos(fi) + (plane_d*ray_dir_y/(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))) - (-ray_dir_y + (plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror)))*(2*ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + 2*ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + 2*ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))))*(ray_length - sqrt(pow(plane_d, 2)*pow(ray_dir_x, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_y, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_z, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2))))*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om));
j.coeffRef(2,4) = (plane_d*ray_dir_x/(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))) - (-ray_dir_x + (2*ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + 2*ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + 2*ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))))*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))))*(ray_length - sqrt(pow(plane_d, 2)*pow(ray_dir_x, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_y, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_z, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2))))*cos(fi)*cos(ka)*cos(om) - (-plane_d*ray_dir_y/(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))) + (-ray_dir_z + (plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))*(2*ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + 2*ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + 2*ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))))*(ray_length - sqrt(pow(plane_d, 2)*pow(ray_dir_x, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_y, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_z, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2))))*sin(fi)*cos(om) - (plane_d*ray_dir_y/(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))) - (-ray_dir_y + (plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror)))*(2*ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + 2*ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + 2*ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))))*(ray_length - sqrt(pow(plane_d, 2)*pow(ray_dir_x, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_y, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_z, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2))))*sin(ka)*cos(fi)*cos(om);
j.coeffRef(2,5) = (plane_d*ray_dir_x/(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))) - (-ray_dir_x + (2*ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + 2*ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + 2*ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))))*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))))*(ray_length - sqrt(pow(plane_d, 2)*pow(ray_dir_x, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_y, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_z, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2))))*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) + (plane_d*ray_dir_y/(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))) - (-ray_dir_y + (plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror)))*(2*ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + 2*ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + 2*ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))))*(ray_length - sqrt(pow(plane_d, 2)*pow(ray_dir_x, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_y, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_z, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2))))*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om));
j.coeffRef(2,6) = (-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka))*(plane_d*ray_dir_y*(-ray_dir_x*cos(fic)*cos(kac) - ray_dir_y*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) - ray_dir_z*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)))/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + (-ray_dir_y + (plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror)))*(2*ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + 2*ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + 2*ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))))*((1.0/2.0)*pow(plane_d, 2)*pow(ray_dir_x, 2)*(-2*ray_dir_x*cos(fic)*cos(kac) - 2*ray_dir_y*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) - 2*ray_dir_z*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)))/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 3) + (1.0/2.0)*pow(plane_d, 2)*pow(ray_dir_y, 2)*(-2*ray_dir_x*cos(fic)*cos(kac) - 2*ray_dir_y*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) - 2*ray_dir_z*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)))/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 3) + (1.0/2.0)*pow(plane_d, 2)*pow(ray_dir_z, 2)*(-2*ray_dir_x*cos(fic)*cos(kac) - 2*ray_dir_y*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) - 2*ray_dir_z*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)))/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 3))/sqrt(pow(plane_d, 2)*pow(ray_dir_x, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_y, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_z, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2)) + (-ray_length + sqrt(pow(plane_d, 2)*pow(ray_dir_x, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_y, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_z, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2)))*((sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc))*(2*ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + 2*ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + 2*ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))) + (plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror)))*(2*ray_dir_x*cos(fic)*cos(kac) + 2*ray_dir_y*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + 2*ray_dir_z*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc))))) + (sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om))*(plane_d*ray_dir_x*(-ray_dir_x*cos(fic)*cos(kac) - ray_dir_y*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) - ray_dir_z*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)))/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + (-ray_dir_x + (2*ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + 2*ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + 2*ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))))*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))))*((1.0/2.0)*pow(plane_d, 2)*pow(ray_dir_x, 2)*(-2*ray_dir_x*cos(fic)*cos(kac) - 2*ray_dir_y*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) - 2*ray_dir_z*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)))/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 3) + (1.0/2.0)*pow(plane_d, 2)*pow(ray_dir_y, 2)*(-2*ray_dir_x*cos(fic)*cos(kac) - 2*ray_dir_y*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) - 2*ray_dir_z*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)))/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 3) + (1.0/2.0)*pow(plane_d, 2)*pow(ray_dir_z, 2)*(-2*ray_dir_x*cos(fic)*cos(kac) - 2*ray_dir_y*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) - 2*ray_dir_z*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)))/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 3))/sqrt(pow(plane_d, 2)*pow(ray_dir_x, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_y, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_z, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2)) + (-ray_length + sqrt(pow(plane_d, 2)*pow(ray_dir_x, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_y, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_z, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2)))*((2*ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + 2*ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + 2*ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))))*cos(fic)*cos(kac) + (plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic)))*(2*ray_dir_x*cos(fic)*cos(kac) + 2*ray_dir_y*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + 2*ray_dir_z*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc))))) + (-plane_d*ray_dir_y*(-ray_dir_x*cos(fic)*cos(kac) - ray_dir_y*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) - ray_dir_z*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)))/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) - (-ray_dir_z + (plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))*(2*ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + 2*ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + 2*ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))))*((1.0/2.0)*pow(plane_d, 2)*pow(ray_dir_x, 2)*(-2*ray_dir_x*cos(fic)*cos(kac) - 2*ray_dir_y*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) - 2*ray_dir_z*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)))/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 3) + (1.0/2.0)*pow(plane_d, 2)*pow(ray_dir_y, 2)*(-2*ray_dir_x*cos(fic)*cos(kac) - 2*ray_dir_y*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) - 2*ray_dir_z*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)))/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 3) + (1.0/2.0)*pow(plane_d, 2)*pow(ray_dir_z, 2)*(-2*ray_dir_x*cos(fic)*cos(kac) - 2*ray_dir_y*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) - 2*ray_dir_z*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)))/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 3))/sqrt(pow(plane_d, 2)*pow(ray_dir_x, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_y, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_z, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2)) - (-ray_length + sqrt(pow(plane_d, 2)*pow(ray_dir_x, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_y, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_z, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2)))*((-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc))*(2*ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + 2*ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + 2*ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))) + (plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))*(2*ray_dir_x*cos(fic)*cos(kac) + 2*ray_dir_y*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + 2*ray_dir_z*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)))))*cos(fi)*cos(om);
j.coeffRef(2,7) = (-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka))*(plane_d*ray_dir_y*(-ray_dir_x*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) - ray_dir_y*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) - ray_dir_z*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)))/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + (-ray_dir_y + (plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror)))*(2*ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + 2*ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + 2*ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))))*((1.0/2.0)*pow(plane_d, 2)*pow(ray_dir_x, 2)*(-2*ray_dir_x*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) - 2*ray_dir_y*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) - 2*ray_dir_z*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)))/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 3) + (1.0/2.0)*pow(plane_d, 2)*pow(ray_dir_y, 2)*(-2*ray_dir_x*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) - 2*ray_dir_y*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) - 2*ray_dir_z*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)))/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 3) + (1.0/2.0)*pow(plane_d, 2)*pow(ray_dir_z, 2)*(-2*ray_dir_x*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) - 2*ray_dir_y*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) - 2*ray_dir_z*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)))/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 3))/sqrt(pow(plane_d, 2)*pow(ray_dir_x, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_y, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_z, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2)) + (-ray_length + sqrt(pow(plane_d, 2)*pow(ray_dir_x, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_y, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_z, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2)))*(((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic))*(2*ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + 2*ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + 2*ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))) + (plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror)))*(2*ray_dir_x*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + 2*ray_dir_y*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + 2*ray_dir_z*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc))))) + (sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om))*(plane_d*ray_dir_x*(-ray_dir_x*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) - ray_dir_y*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) - ray_dir_z*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)))/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + (-ray_dir_x + (2*ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + 2*ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + 2*ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))))*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))))*((1.0/2.0)*pow(plane_d, 2)*pow(ray_dir_x, 2)*(-2*ray_dir_x*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) - 2*ray_dir_y*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) - 2*ray_dir_z*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)))/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 3) + (1.0/2.0)*pow(plane_d, 2)*pow(ray_dir_y, 2)*(-2*ray_dir_x*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) - 2*ray_dir_y*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) - 2*ray_dir_z*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)))/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 3) + (1.0/2.0)*pow(plane_d, 2)*pow(ray_dir_z, 2)*(-2*ray_dir_x*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) - 2*ray_dir_y*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) - 2*ray_dir_z*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)))/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 3))/sqrt(pow(plane_d, 2)*pow(ray_dir_x, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_y, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_z, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2)) + (-ray_length + sqrt(pow(plane_d, 2)*pow(ray_dir_x, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_y, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_z, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2)))*((sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror))*(2*ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + 2*ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + 2*ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))) + (2*ray_dir_x*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + 2*ray_dir_y*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + 2*ray_dir_z*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)))*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))))) + (-plane_d*ray_dir_y*(-ray_dir_x*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) - ray_dir_y*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) - ray_dir_z*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)))/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) - (-ray_dir_z + (plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))*(2*ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + 2*ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + 2*ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))))*((1.0/2.0)*pow(plane_d, 2)*pow(ray_dir_x, 2)*(-2*ray_dir_x*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) - 2*ray_dir_y*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) - 2*ray_dir_z*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)))/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 3) + (1.0/2.0)*pow(plane_d, 2)*pow(ray_dir_y, 2)*(-2*ray_dir_x*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) - 2*ray_dir_y*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) - 2*ray_dir_z*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)))/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 3) + (1.0/2.0)*pow(plane_d, 2)*pow(ray_dir_z, 2)*(-2*ray_dir_x*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) - 2*ray_dir_y*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) - 2*ray_dir_z*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)))/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 3))/sqrt(pow(plane_d, 2)*pow(ray_dir_x, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_y, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_z, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2)) - (-ray_length + sqrt(pow(plane_d, 2)*pow(ray_dir_x, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_y, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_z, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2)))*(((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc))*(2*ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + 2*ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + 2*ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))) + (plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))*(2*ray_dir_x*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + 2*ray_dir_y*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + 2*ray_dir_z*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)))))*cos(fi)*cos(om);
j.coeffRef(2,8) = (-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka))*(plane_d*ray_dir_y*(-ray_dir_x*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic)) - ray_dir_y*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror)) - ray_dir_z*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + (-ray_dir_y + (plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror)))*(2*ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + 2*ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + 2*ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))))*((1.0/2.0)*pow(plane_d, 2)*pow(ray_dir_x, 2)*(-2*ray_dir_x*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic)) - 2*ray_dir_y*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror)) - 2*ray_dir_z*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 3) + (1.0/2.0)*pow(plane_d, 2)*pow(ray_dir_y, 2)*(-2*ray_dir_x*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic)) - 2*ray_dir_y*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror)) - 2*ray_dir_z*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 3) + (1.0/2.0)*pow(plane_d, 2)*pow(ray_dir_z, 2)*(-2*ray_dir_x*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic)) - 2*ray_dir_y*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror)) - 2*ray_dir_z*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 3))/sqrt(pow(plane_d, 2)*pow(ray_dir_x, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_y, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_z, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2)) + (-ray_length + sqrt(pow(plane_d, 2)*pow(ray_dir_x, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_y, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_z, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2)))*((-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))*(2*ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + 2*ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + 2*ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))) + (plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror)))*(2*ray_dir_x*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic)) + 2*ray_dir_y*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror)) + 2*ray_dir_z*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))))) + (sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om))*(plane_d*ray_dir_x*(-ray_dir_x*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic)) - ray_dir_y*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror)) - ray_dir_z*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + (-ray_dir_x + (2*ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + 2*ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + 2*ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))))*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))))*((1.0/2.0)*pow(plane_d, 2)*pow(ray_dir_x, 2)*(-2*ray_dir_x*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic)) - 2*ray_dir_y*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror)) - 2*ray_dir_z*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 3) + (1.0/2.0)*pow(plane_d, 2)*pow(ray_dir_y, 2)*(-2*ray_dir_x*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic)) - 2*ray_dir_y*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror)) - 2*ray_dir_z*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 3) + (1.0/2.0)*pow(plane_d, 2)*pow(ray_dir_z, 2)*(-2*ray_dir_x*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic)) - 2*ray_dir_y*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror)) - 2*ray_dir_z*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 3))/sqrt(pow(plane_d, 2)*pow(ray_dir_x, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_y, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_z, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2)) + (-ray_length + sqrt(pow(plane_d, 2)*pow(ray_dir_x, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_y, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_z, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2)))*((sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))*(2*ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + 2*ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + 2*ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))) + (2*ray_dir_x*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic)) + 2*ray_dir_y*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror)) + 2*ray_dir_z*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))))) + (-plane_d*ray_dir_y*(-ray_dir_x*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic)) - ray_dir_y*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror)) - ray_dir_z*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) - (-ray_dir_z + (plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))*(2*ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + 2*ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + 2*ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))))*((1.0/2.0)*pow(plane_d, 2)*pow(ray_dir_x, 2)*(-2*ray_dir_x*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic)) - 2*ray_dir_y*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror)) - 2*ray_dir_z*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 3) + (1.0/2.0)*pow(plane_d, 2)*pow(ray_dir_y, 2)*(-2*ray_dir_x*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic)) - 2*ray_dir_y*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror)) - 2*ray_dir_z*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 3) + (1.0/2.0)*pow(plane_d, 2)*pow(ray_dir_z, 2)*(-2*ray_dir_x*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic)) - 2*ray_dir_y*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror)) - 2*ray_dir_z*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 3))/sqrt(pow(plane_d, 2)*pow(ray_dir_x, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_y, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_z, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2)) - (-ray_length + sqrt(pow(plane_d, 2)*pow(ray_dir_x, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_y, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_z, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2)))*((-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))*(2*ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + 2*ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + 2*ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))) + (plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))*(2*ray_dir_x*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic)) + 2*ray_dir_y*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror)) + 2*ray_dir_z*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))))*cos(fi)*cos(om);
j.coeffRef(2,9) = (ray_dir_x/(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))) + (-ray_dir_x + (2*ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + 2*ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + 2*ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))))*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))))*(plane_d*pow(ray_dir_x, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + plane_d*pow(ray_dir_y, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + plane_d*pow(ray_dir_z, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2))/sqrt(pow(plane_d, 2)*pow(ray_dir_x, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_y, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_z, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2)))*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + (-ray_dir_y/(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))) - (-ray_dir_z + (plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))*(2*ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + 2*ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + 2*ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))))*(plane_d*pow(ray_dir_x, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + plane_d*pow(ray_dir_y, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + plane_d*pow(ray_dir_z, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2))/sqrt(pow(plane_d, 2)*pow(ray_dir_x, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_y, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_z, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2)))*cos(fi)*cos(om) + (ray_dir_y/(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))) + (-ray_dir_y + (plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror)))*(2*ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + 2*ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + 2*ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))))*(plane_d*pow(ray_dir_x, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + plane_d*pow(ray_dir_y, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + plane_d*pow(ray_dir_z, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2))/sqrt(pow(plane_d, 2)*pow(ray_dir_x, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_y, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_z, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2)))*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka));
j.coeffRef(2,10) = 0;
j.coeffRef(2,11) = 0;
j.coeffRef(2,12) = (-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka))*(plane_d*ray_dir_y*(-ray_dir_x*(-plane_a*sin(fic)*cos(kac) + plane_b*(sin(fic)*sin(kac)*cos(om_mirror) + sin(om_mirror)*cos(fic)) + plane_c*(-sin(fic)*sin(kac)*sin(om_mirror) + cos(fic)*cos(om_mirror))) - ray_dir_y*(plane_a*sin(omc)*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror)*sin(omc) - sin(kac)*sin(omc)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*sin(omc)*cos(om_mirror) + sin(kac)*sin(om_mirror)*sin(omc)*cos(fic))) - ray_dir_z*(-plane_a*cos(fic)*cos(kac)*cos(omc) + plane_b*(-sin(fic)*sin(om_mirror)*cos(omc) + sin(kac)*cos(fic)*cos(om_mirror)*cos(omc)) + plane_c*(-sin(fic)*cos(om_mirror)*cos(omc) - sin(kac)*sin(om_mirror)*cos(fic)*cos(omc))))/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + (-ray_dir_y + (plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror)))*(2*ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + 2*ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + 2*ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))))*((1.0/2.0)*pow(plane_d, 2)*pow(ray_dir_x, 2)*(-2*ray_dir_x*(-plane_a*sin(fic)*cos(kac) + plane_b*(sin(fic)*sin(kac)*cos(om_mirror) + sin(om_mirror)*cos(fic)) + plane_c*(-sin(fic)*sin(kac)*sin(om_mirror) + cos(fic)*cos(om_mirror))) - 2*ray_dir_y*(plane_a*sin(omc)*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror)*sin(omc) - sin(kac)*sin(omc)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*sin(omc)*cos(om_mirror) + sin(kac)*sin(om_mirror)*sin(omc)*cos(fic))) - 2*ray_dir_z*(-plane_a*cos(fic)*cos(kac)*cos(omc) + plane_b*(-sin(fic)*sin(om_mirror)*cos(omc) + sin(kac)*cos(fic)*cos(om_mirror)*cos(omc)) + plane_c*(-sin(fic)*cos(om_mirror)*cos(omc) - sin(kac)*sin(om_mirror)*cos(fic)*cos(omc))))/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 3) + (1.0/2.0)*pow(plane_d, 2)*pow(ray_dir_y, 2)*(-2*ray_dir_x*(-plane_a*sin(fic)*cos(kac) + plane_b*(sin(fic)*sin(kac)*cos(om_mirror) + sin(om_mirror)*cos(fic)) + plane_c*(-sin(fic)*sin(kac)*sin(om_mirror) + cos(fic)*cos(om_mirror))) - 2*ray_dir_y*(plane_a*sin(omc)*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror)*sin(omc) - sin(kac)*sin(omc)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*sin(omc)*cos(om_mirror) + sin(kac)*sin(om_mirror)*sin(omc)*cos(fic))) - 2*ray_dir_z*(-plane_a*cos(fic)*cos(kac)*cos(omc) + plane_b*(-sin(fic)*sin(om_mirror)*cos(omc) + sin(kac)*cos(fic)*cos(om_mirror)*cos(omc)) + plane_c*(-sin(fic)*cos(om_mirror)*cos(omc) - sin(kac)*sin(om_mirror)*cos(fic)*cos(omc))))/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 3) + (1.0/2.0)*pow(plane_d, 2)*pow(ray_dir_z, 2)*(-2*ray_dir_x*(-plane_a*sin(fic)*cos(kac) + plane_b*(sin(fic)*sin(kac)*cos(om_mirror) + sin(om_mirror)*cos(fic)) + plane_c*(-sin(fic)*sin(kac)*sin(om_mirror) + cos(fic)*cos(om_mirror))) - 2*ray_dir_y*(plane_a*sin(omc)*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror)*sin(omc) - sin(kac)*sin(omc)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*sin(omc)*cos(om_mirror) + sin(kac)*sin(om_mirror)*sin(omc)*cos(fic))) - 2*ray_dir_z*(-plane_a*cos(fic)*cos(kac)*cos(omc) + plane_b*(-sin(fic)*sin(om_mirror)*cos(omc) + sin(kac)*cos(fic)*cos(om_mirror)*cos(omc)) + plane_c*(-sin(fic)*cos(om_mirror)*cos(omc) - sin(kac)*sin(om_mirror)*cos(fic)*cos(omc))))/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 3))/sqrt(pow(plane_d, 2)*pow(ray_dir_x, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_y, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_z, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2)) + (-ray_length + sqrt(pow(plane_d, 2)*pow(ray_dir_x, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_y, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_z, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2)))*((plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror)))*(2*ray_dir_x*(-plane_a*sin(fic)*cos(kac) + plane_b*(sin(fic)*sin(kac)*cos(om_mirror) + sin(om_mirror)*cos(fic)) + plane_c*(-sin(fic)*sin(kac)*sin(om_mirror) + cos(fic)*cos(om_mirror))) + 2*ray_dir_y*(plane_a*sin(omc)*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror)*sin(omc) - sin(kac)*sin(omc)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*sin(omc)*cos(om_mirror) + sin(kac)*sin(om_mirror)*sin(omc)*cos(fic))) + 2*ray_dir_z*(-plane_a*cos(fic)*cos(kac)*cos(omc) + plane_b*(-sin(fic)*sin(om_mirror)*cos(omc) + sin(kac)*cos(fic)*cos(om_mirror)*cos(omc)) + plane_c*(-sin(fic)*cos(om_mirror)*cos(omc) - sin(kac)*sin(om_mirror)*cos(fic)*cos(omc)))) + (2*ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + 2*ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + 2*ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))))*(plane_a*sin(omc)*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror)*sin(omc) - sin(kac)*sin(omc)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*sin(omc)*cos(om_mirror) + sin(kac)*sin(om_mirror)*sin(omc)*cos(fic))))) + (sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om))*(plane_d*ray_dir_x*(-ray_dir_x*(-plane_a*sin(fic)*cos(kac) + plane_b*(sin(fic)*sin(kac)*cos(om_mirror) + sin(om_mirror)*cos(fic)) + plane_c*(-sin(fic)*sin(kac)*sin(om_mirror) + cos(fic)*cos(om_mirror))) - ray_dir_y*(plane_a*sin(omc)*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror)*sin(omc) - sin(kac)*sin(omc)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*sin(omc)*cos(om_mirror) + sin(kac)*sin(om_mirror)*sin(omc)*cos(fic))) - ray_dir_z*(-plane_a*cos(fic)*cos(kac)*cos(omc) + plane_b*(-sin(fic)*sin(om_mirror)*cos(omc) + sin(kac)*cos(fic)*cos(om_mirror)*cos(omc)) + plane_c*(-sin(fic)*cos(om_mirror)*cos(omc) - sin(kac)*sin(om_mirror)*cos(fic)*cos(omc))))/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + (-ray_dir_x + (2*ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + 2*ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + 2*ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))))*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))))*((1.0/2.0)*pow(plane_d, 2)*pow(ray_dir_x, 2)*(-2*ray_dir_x*(-plane_a*sin(fic)*cos(kac) + plane_b*(sin(fic)*sin(kac)*cos(om_mirror) + sin(om_mirror)*cos(fic)) + plane_c*(-sin(fic)*sin(kac)*sin(om_mirror) + cos(fic)*cos(om_mirror))) - 2*ray_dir_y*(plane_a*sin(omc)*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror)*sin(omc) - sin(kac)*sin(omc)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*sin(omc)*cos(om_mirror) + sin(kac)*sin(om_mirror)*sin(omc)*cos(fic))) - 2*ray_dir_z*(-plane_a*cos(fic)*cos(kac)*cos(omc) + plane_b*(-sin(fic)*sin(om_mirror)*cos(omc) + sin(kac)*cos(fic)*cos(om_mirror)*cos(omc)) + plane_c*(-sin(fic)*cos(om_mirror)*cos(omc) - sin(kac)*sin(om_mirror)*cos(fic)*cos(omc))))/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 3) + (1.0/2.0)*pow(plane_d, 2)*pow(ray_dir_y, 2)*(-2*ray_dir_x*(-plane_a*sin(fic)*cos(kac) + plane_b*(sin(fic)*sin(kac)*cos(om_mirror) + sin(om_mirror)*cos(fic)) + plane_c*(-sin(fic)*sin(kac)*sin(om_mirror) + cos(fic)*cos(om_mirror))) - 2*ray_dir_y*(plane_a*sin(omc)*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror)*sin(omc) - sin(kac)*sin(omc)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*sin(omc)*cos(om_mirror) + sin(kac)*sin(om_mirror)*sin(omc)*cos(fic))) - 2*ray_dir_z*(-plane_a*cos(fic)*cos(kac)*cos(omc) + plane_b*(-sin(fic)*sin(om_mirror)*cos(omc) + sin(kac)*cos(fic)*cos(om_mirror)*cos(omc)) + plane_c*(-sin(fic)*cos(om_mirror)*cos(omc) - sin(kac)*sin(om_mirror)*cos(fic)*cos(omc))))/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 3) + (1.0/2.0)*pow(plane_d, 2)*pow(ray_dir_z, 2)*(-2*ray_dir_x*(-plane_a*sin(fic)*cos(kac) + plane_b*(sin(fic)*sin(kac)*cos(om_mirror) + sin(om_mirror)*cos(fic)) + plane_c*(-sin(fic)*sin(kac)*sin(om_mirror) + cos(fic)*cos(om_mirror))) - 2*ray_dir_y*(plane_a*sin(omc)*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror)*sin(omc) - sin(kac)*sin(omc)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*sin(omc)*cos(om_mirror) + sin(kac)*sin(om_mirror)*sin(omc)*cos(fic))) - 2*ray_dir_z*(-plane_a*cos(fic)*cos(kac)*cos(omc) + plane_b*(-sin(fic)*sin(om_mirror)*cos(omc) + sin(kac)*cos(fic)*cos(om_mirror)*cos(omc)) + plane_c*(-sin(fic)*cos(om_mirror)*cos(omc) - sin(kac)*sin(om_mirror)*cos(fic)*cos(omc))))/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 3))/sqrt(pow(plane_d, 2)*pow(ray_dir_x, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_y, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_z, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2)) + (-ray_length + sqrt(pow(plane_d, 2)*pow(ray_dir_x, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_y, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_z, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2)))*((2*ray_dir_x*(-plane_a*sin(fic)*cos(kac) + plane_b*(sin(fic)*sin(kac)*cos(om_mirror) + sin(om_mirror)*cos(fic)) + plane_c*(-sin(fic)*sin(kac)*sin(om_mirror) + cos(fic)*cos(om_mirror))) + 2*ray_dir_y*(plane_a*sin(omc)*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror)*sin(omc) - sin(kac)*sin(omc)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*sin(omc)*cos(om_mirror) + sin(kac)*sin(om_mirror)*sin(omc)*cos(fic))) + 2*ray_dir_z*(-plane_a*cos(fic)*cos(kac)*cos(omc) + plane_b*(-sin(fic)*sin(om_mirror)*cos(omc) + sin(kac)*cos(fic)*cos(om_mirror)*cos(omc)) + plane_c*(-sin(fic)*cos(om_mirror)*cos(omc) - sin(kac)*sin(om_mirror)*cos(fic)*cos(omc))))*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + (2*ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + 2*ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + 2*ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))))*(-plane_a*sin(fic)*cos(kac) + plane_b*(sin(fic)*sin(kac)*cos(om_mirror) + sin(om_mirror)*cos(fic)) + plane_c*(-sin(fic)*sin(kac)*sin(om_mirror) + cos(fic)*cos(om_mirror))))) + (-plane_d*ray_dir_y*(-ray_dir_x*(-plane_a*sin(fic)*cos(kac) + plane_b*(sin(fic)*sin(kac)*cos(om_mirror) + sin(om_mirror)*cos(fic)) + plane_c*(-sin(fic)*sin(kac)*sin(om_mirror) + cos(fic)*cos(om_mirror))) - ray_dir_y*(plane_a*sin(omc)*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror)*sin(omc) - sin(kac)*sin(omc)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*sin(omc)*cos(om_mirror) + sin(kac)*sin(om_mirror)*sin(omc)*cos(fic))) - ray_dir_z*(-plane_a*cos(fic)*cos(kac)*cos(omc) + plane_b*(-sin(fic)*sin(om_mirror)*cos(omc) + sin(kac)*cos(fic)*cos(om_mirror)*cos(omc)) + plane_c*(-sin(fic)*cos(om_mirror)*cos(omc) - sin(kac)*sin(om_mirror)*cos(fic)*cos(omc))))/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) - (-ray_dir_z + (plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))*(2*ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + 2*ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + 2*ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))))*((1.0/2.0)*pow(plane_d, 2)*pow(ray_dir_x, 2)*(-2*ray_dir_x*(-plane_a*sin(fic)*cos(kac) + plane_b*(sin(fic)*sin(kac)*cos(om_mirror) + sin(om_mirror)*cos(fic)) + plane_c*(-sin(fic)*sin(kac)*sin(om_mirror) + cos(fic)*cos(om_mirror))) - 2*ray_dir_y*(plane_a*sin(omc)*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror)*sin(omc) - sin(kac)*sin(omc)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*sin(omc)*cos(om_mirror) + sin(kac)*sin(om_mirror)*sin(omc)*cos(fic))) - 2*ray_dir_z*(-plane_a*cos(fic)*cos(kac)*cos(omc) + plane_b*(-sin(fic)*sin(om_mirror)*cos(omc) + sin(kac)*cos(fic)*cos(om_mirror)*cos(omc)) + plane_c*(-sin(fic)*cos(om_mirror)*cos(omc) - sin(kac)*sin(om_mirror)*cos(fic)*cos(omc))))/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 3) + (1.0/2.0)*pow(plane_d, 2)*pow(ray_dir_y, 2)*(-2*ray_dir_x*(-plane_a*sin(fic)*cos(kac) + plane_b*(sin(fic)*sin(kac)*cos(om_mirror) + sin(om_mirror)*cos(fic)) + plane_c*(-sin(fic)*sin(kac)*sin(om_mirror) + cos(fic)*cos(om_mirror))) - 2*ray_dir_y*(plane_a*sin(omc)*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror)*sin(omc) - sin(kac)*sin(omc)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*sin(omc)*cos(om_mirror) + sin(kac)*sin(om_mirror)*sin(omc)*cos(fic))) - 2*ray_dir_z*(-plane_a*cos(fic)*cos(kac)*cos(omc) + plane_b*(-sin(fic)*sin(om_mirror)*cos(omc) + sin(kac)*cos(fic)*cos(om_mirror)*cos(omc)) + plane_c*(-sin(fic)*cos(om_mirror)*cos(omc) - sin(kac)*sin(om_mirror)*cos(fic)*cos(omc))))/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 3) + (1.0/2.0)*pow(plane_d, 2)*pow(ray_dir_z, 2)*(-2*ray_dir_x*(-plane_a*sin(fic)*cos(kac) + plane_b*(sin(fic)*sin(kac)*cos(om_mirror) + sin(om_mirror)*cos(fic)) + plane_c*(-sin(fic)*sin(kac)*sin(om_mirror) + cos(fic)*cos(om_mirror))) - 2*ray_dir_y*(plane_a*sin(omc)*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror)*sin(omc) - sin(kac)*sin(omc)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*sin(omc)*cos(om_mirror) + sin(kac)*sin(om_mirror)*sin(omc)*cos(fic))) - 2*ray_dir_z*(-plane_a*cos(fic)*cos(kac)*cos(omc) + plane_b*(-sin(fic)*sin(om_mirror)*cos(omc) + sin(kac)*cos(fic)*cos(om_mirror)*cos(omc)) + plane_c*(-sin(fic)*cos(om_mirror)*cos(omc) - sin(kac)*sin(om_mirror)*cos(fic)*cos(omc))))/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 3))/sqrt(pow(plane_d, 2)*pow(ray_dir_x, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_y, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_z, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2)) - (-ray_length + sqrt(pow(plane_d, 2)*pow(ray_dir_x, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_y, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_z, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2)))*((plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))*(2*ray_dir_x*(-plane_a*sin(fic)*cos(kac) + plane_b*(sin(fic)*sin(kac)*cos(om_mirror) + sin(om_mirror)*cos(fic)) + plane_c*(-sin(fic)*sin(kac)*sin(om_mirror) + cos(fic)*cos(om_mirror))) + 2*ray_dir_y*(plane_a*sin(omc)*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror)*sin(omc) - sin(kac)*sin(omc)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*sin(omc)*cos(om_mirror) + sin(kac)*sin(om_mirror)*sin(omc)*cos(fic))) + 2*ray_dir_z*(-plane_a*cos(fic)*cos(kac)*cos(omc) + plane_b*(-sin(fic)*sin(om_mirror)*cos(omc) + sin(kac)*cos(fic)*cos(om_mirror)*cos(omc)) + plane_c*(-sin(fic)*cos(om_mirror)*cos(omc) - sin(kac)*sin(om_mirror)*cos(fic)*cos(omc)))) + (2*ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + 2*ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + 2*ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))))*(-plane_a*cos(fic)*cos(kac)*cos(omc) + plane_b*(-sin(fic)*sin(om_mirror)*cos(omc) + sin(kac)*cos(fic)*cos(om_mirror)*cos(omc)) + plane_c*(-sin(fic)*cos(om_mirror)*cos(omc) - sin(kac)*sin(om_mirror)*cos(fic)*cos(omc)))))*cos(fi)*cos(om);
j.coeffRef(2,13) = (-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka))*(plane_d*ray_dir_y*(-ray_dir_x*(-plane_a*sin(kac)*cos(fic) - plane_b*cos(fic)*cos(kac)*cos(om_mirror) + plane_c*sin(om_mirror)*cos(fic)*cos(kac)) - ray_dir_y*(plane_a*(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc)) + plane_b*(-sin(fic)*sin(omc)*cos(kac) - sin(kac)*cos(omc))*cos(om_mirror) + plane_c*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc))*sin(om_mirror)) - ray_dir_z*(plane_a*(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac)) + plane_b*(sin(fic)*cos(kac)*cos(omc) - sin(kac)*sin(omc))*cos(om_mirror) + plane_c*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc))*sin(om_mirror)))/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + (-ray_dir_y + (plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror)))*(2*ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + 2*ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + 2*ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))))*((1.0/2.0)*pow(plane_d, 2)*pow(ray_dir_x, 2)*(-2*ray_dir_x*(-plane_a*sin(kac)*cos(fic) - plane_b*cos(fic)*cos(kac)*cos(om_mirror) + plane_c*sin(om_mirror)*cos(fic)*cos(kac)) - 2*ray_dir_y*(plane_a*(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc)) + plane_b*(-sin(fic)*sin(omc)*cos(kac) - sin(kac)*cos(omc))*cos(om_mirror) + plane_c*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc))*sin(om_mirror)) - 2*ray_dir_z*(plane_a*(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac)) + plane_b*(sin(fic)*cos(kac)*cos(omc) - sin(kac)*sin(omc))*cos(om_mirror) + plane_c*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc))*sin(om_mirror)))/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 3) + (1.0/2.0)*pow(plane_d, 2)*pow(ray_dir_y, 2)*(-2*ray_dir_x*(-plane_a*sin(kac)*cos(fic) - plane_b*cos(fic)*cos(kac)*cos(om_mirror) + plane_c*sin(om_mirror)*cos(fic)*cos(kac)) - 2*ray_dir_y*(plane_a*(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc)) + plane_b*(-sin(fic)*sin(omc)*cos(kac) - sin(kac)*cos(omc))*cos(om_mirror) + plane_c*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc))*sin(om_mirror)) - 2*ray_dir_z*(plane_a*(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac)) + plane_b*(sin(fic)*cos(kac)*cos(omc) - sin(kac)*sin(omc))*cos(om_mirror) + plane_c*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc))*sin(om_mirror)))/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 3) + (1.0/2.0)*pow(plane_d, 2)*pow(ray_dir_z, 2)*(-2*ray_dir_x*(-plane_a*sin(kac)*cos(fic) - plane_b*cos(fic)*cos(kac)*cos(om_mirror) + plane_c*sin(om_mirror)*cos(fic)*cos(kac)) - 2*ray_dir_y*(plane_a*(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc)) + plane_b*(-sin(fic)*sin(omc)*cos(kac) - sin(kac)*cos(omc))*cos(om_mirror) + plane_c*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc))*sin(om_mirror)) - 2*ray_dir_z*(plane_a*(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac)) + plane_b*(sin(fic)*cos(kac)*cos(omc) - sin(kac)*sin(omc))*cos(om_mirror) + plane_c*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc))*sin(om_mirror)))/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 3))/sqrt(pow(plane_d, 2)*pow(ray_dir_x, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_y, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_z, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2)) + (-ray_length + sqrt(pow(plane_d, 2)*pow(ray_dir_x, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_y, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_z, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2)))*((plane_a*(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc)) + plane_b*(-sin(fic)*sin(omc)*cos(kac) - sin(kac)*cos(omc))*cos(om_mirror) + plane_c*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc))*sin(om_mirror))*(2*ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + 2*ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + 2*ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))) + (plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror)))*(2*ray_dir_x*(-plane_a*sin(kac)*cos(fic) - plane_b*cos(fic)*cos(kac)*cos(om_mirror) + plane_c*sin(om_mirror)*cos(fic)*cos(kac)) + 2*ray_dir_y*(plane_a*(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc)) + plane_b*(-sin(fic)*sin(omc)*cos(kac) - sin(kac)*cos(omc))*cos(om_mirror) + plane_c*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc))*sin(om_mirror)) + 2*ray_dir_z*(plane_a*(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac)) + plane_b*(sin(fic)*cos(kac)*cos(omc) - sin(kac)*sin(omc))*cos(om_mirror) + plane_c*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc))*sin(om_mirror))))) + (sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om))*(plane_d*ray_dir_x*(-ray_dir_x*(-plane_a*sin(kac)*cos(fic) - plane_b*cos(fic)*cos(kac)*cos(om_mirror) + plane_c*sin(om_mirror)*cos(fic)*cos(kac)) - ray_dir_y*(plane_a*(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc)) + plane_b*(-sin(fic)*sin(omc)*cos(kac) - sin(kac)*cos(omc))*cos(om_mirror) + plane_c*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc))*sin(om_mirror)) - ray_dir_z*(plane_a*(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac)) + plane_b*(sin(fic)*cos(kac)*cos(omc) - sin(kac)*sin(omc))*cos(om_mirror) + plane_c*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc))*sin(om_mirror)))/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + (-ray_dir_x + (2*ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + 2*ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + 2*ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))))*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))))*((1.0/2.0)*pow(plane_d, 2)*pow(ray_dir_x, 2)*(-2*ray_dir_x*(-plane_a*sin(kac)*cos(fic) - plane_b*cos(fic)*cos(kac)*cos(om_mirror) + plane_c*sin(om_mirror)*cos(fic)*cos(kac)) - 2*ray_dir_y*(plane_a*(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc)) + plane_b*(-sin(fic)*sin(omc)*cos(kac) - sin(kac)*cos(omc))*cos(om_mirror) + plane_c*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc))*sin(om_mirror)) - 2*ray_dir_z*(plane_a*(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac)) + plane_b*(sin(fic)*cos(kac)*cos(omc) - sin(kac)*sin(omc))*cos(om_mirror) + plane_c*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc))*sin(om_mirror)))/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 3) + (1.0/2.0)*pow(plane_d, 2)*pow(ray_dir_y, 2)*(-2*ray_dir_x*(-plane_a*sin(kac)*cos(fic) - plane_b*cos(fic)*cos(kac)*cos(om_mirror) + plane_c*sin(om_mirror)*cos(fic)*cos(kac)) - 2*ray_dir_y*(plane_a*(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc)) + plane_b*(-sin(fic)*sin(omc)*cos(kac) - sin(kac)*cos(omc))*cos(om_mirror) + plane_c*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc))*sin(om_mirror)) - 2*ray_dir_z*(plane_a*(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac)) + plane_b*(sin(fic)*cos(kac)*cos(omc) - sin(kac)*sin(omc))*cos(om_mirror) + plane_c*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc))*sin(om_mirror)))/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 3) + (1.0/2.0)*pow(plane_d, 2)*pow(ray_dir_z, 2)*(-2*ray_dir_x*(-plane_a*sin(kac)*cos(fic) - plane_b*cos(fic)*cos(kac)*cos(om_mirror) + plane_c*sin(om_mirror)*cos(fic)*cos(kac)) - 2*ray_dir_y*(plane_a*(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc)) + plane_b*(-sin(fic)*sin(omc)*cos(kac) - sin(kac)*cos(omc))*cos(om_mirror) + plane_c*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc))*sin(om_mirror)) - 2*ray_dir_z*(plane_a*(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac)) + plane_b*(sin(fic)*cos(kac)*cos(omc) - sin(kac)*sin(omc))*cos(om_mirror) + plane_c*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc))*sin(om_mirror)))/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 3))/sqrt(pow(plane_d, 2)*pow(ray_dir_x, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_y, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_z, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2)) + (-ray_length + sqrt(pow(plane_d, 2)*pow(ray_dir_x, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_y, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_z, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2)))*((2*ray_dir_x*(-plane_a*sin(kac)*cos(fic) - plane_b*cos(fic)*cos(kac)*cos(om_mirror) + plane_c*sin(om_mirror)*cos(fic)*cos(kac)) + 2*ray_dir_y*(plane_a*(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc)) + plane_b*(-sin(fic)*sin(omc)*cos(kac) - sin(kac)*cos(omc))*cos(om_mirror) + plane_c*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc))*sin(om_mirror)) + 2*ray_dir_z*(plane_a*(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac)) + plane_b*(sin(fic)*cos(kac)*cos(omc) - sin(kac)*sin(omc))*cos(om_mirror) + plane_c*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc))*sin(om_mirror)))*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + (2*ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + 2*ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + 2*ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))))*(-plane_a*sin(kac)*cos(fic) - plane_b*cos(fic)*cos(kac)*cos(om_mirror) + plane_c*sin(om_mirror)*cos(fic)*cos(kac)))) + (-plane_d*ray_dir_y*(-ray_dir_x*(-plane_a*sin(kac)*cos(fic) - plane_b*cos(fic)*cos(kac)*cos(om_mirror) + plane_c*sin(om_mirror)*cos(fic)*cos(kac)) - ray_dir_y*(plane_a*(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc)) + plane_b*(-sin(fic)*sin(omc)*cos(kac) - sin(kac)*cos(omc))*cos(om_mirror) + plane_c*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc))*sin(om_mirror)) - ray_dir_z*(plane_a*(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac)) + plane_b*(sin(fic)*cos(kac)*cos(omc) - sin(kac)*sin(omc))*cos(om_mirror) + plane_c*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc))*sin(om_mirror)))/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) - (-ray_dir_z + (plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))*(2*ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + 2*ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + 2*ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))))*((1.0/2.0)*pow(plane_d, 2)*pow(ray_dir_x, 2)*(-2*ray_dir_x*(-plane_a*sin(kac)*cos(fic) - plane_b*cos(fic)*cos(kac)*cos(om_mirror) + plane_c*sin(om_mirror)*cos(fic)*cos(kac)) - 2*ray_dir_y*(plane_a*(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc)) + plane_b*(-sin(fic)*sin(omc)*cos(kac) - sin(kac)*cos(omc))*cos(om_mirror) + plane_c*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc))*sin(om_mirror)) - 2*ray_dir_z*(plane_a*(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac)) + plane_b*(sin(fic)*cos(kac)*cos(omc) - sin(kac)*sin(omc))*cos(om_mirror) + plane_c*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc))*sin(om_mirror)))/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 3) + (1.0/2.0)*pow(plane_d, 2)*pow(ray_dir_y, 2)*(-2*ray_dir_x*(-plane_a*sin(kac)*cos(fic) - plane_b*cos(fic)*cos(kac)*cos(om_mirror) + plane_c*sin(om_mirror)*cos(fic)*cos(kac)) - 2*ray_dir_y*(plane_a*(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc)) + plane_b*(-sin(fic)*sin(omc)*cos(kac) - sin(kac)*cos(omc))*cos(om_mirror) + plane_c*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc))*sin(om_mirror)) - 2*ray_dir_z*(plane_a*(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac)) + plane_b*(sin(fic)*cos(kac)*cos(omc) - sin(kac)*sin(omc))*cos(om_mirror) + plane_c*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc))*sin(om_mirror)))/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 3) + (1.0/2.0)*pow(plane_d, 2)*pow(ray_dir_z, 2)*(-2*ray_dir_x*(-plane_a*sin(kac)*cos(fic) - plane_b*cos(fic)*cos(kac)*cos(om_mirror) + plane_c*sin(om_mirror)*cos(fic)*cos(kac)) - 2*ray_dir_y*(plane_a*(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc)) + plane_b*(-sin(fic)*sin(omc)*cos(kac) - sin(kac)*cos(omc))*cos(om_mirror) + plane_c*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc))*sin(om_mirror)) - 2*ray_dir_z*(plane_a*(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac)) + plane_b*(sin(fic)*cos(kac)*cos(omc) - sin(kac)*sin(omc))*cos(om_mirror) + plane_c*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc))*sin(om_mirror)))/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 3))/sqrt(pow(plane_d, 2)*pow(ray_dir_x, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_y, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_z, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2)) - (-ray_length + sqrt(pow(plane_d, 2)*pow(ray_dir_x, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_y, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_z, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2)))*((plane_a*(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac)) + plane_b*(sin(fic)*cos(kac)*cos(omc) - sin(kac)*sin(omc))*cos(om_mirror) + plane_c*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc))*sin(om_mirror))*(2*ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + 2*ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + 2*ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))) + (plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))*(2*ray_dir_x*(-plane_a*sin(kac)*cos(fic) - plane_b*cos(fic)*cos(kac)*cos(om_mirror) + plane_c*sin(om_mirror)*cos(fic)*cos(kac)) + 2*ray_dir_y*(plane_a*(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc)) + plane_b*(-sin(fic)*sin(omc)*cos(kac) - sin(kac)*cos(omc))*cos(om_mirror) + plane_c*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc))*sin(om_mirror)) + 2*ray_dir_z*(plane_a*(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac)) + plane_b*(sin(fic)*cos(kac)*cos(omc) - sin(kac)*sin(omc))*cos(om_mirror) + plane_c*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc))*sin(om_mirror)))))*cos(fi)*cos(om);
}
inline void point_to_point_source_to_target_rotated_mirror_tait_bryan_wc(Eigen::Matrix<double, 3, 1> &delta, double &px, double &py, double &pz, double &om, double &fi, double &ka, double &ray_dir_x, double &ray_dir_y, double &ray_dir_z, double &ray_length, double &plane_a, double &plane_b, double &plane_c, double &plane_d, double &x_t, double &y_t, double &z_t, double &om_mirror, double &pxc, double &pyc, double &pzc, double &omc, double &fic, double &kac)
{delta.coeffRef(0,0) = -px + x_t - (plane_d*ray_dir_x/(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))) - (-ray_dir_x + (2*ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + 2*ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + 2*ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))))*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))))*(ray_length - sqrt(pow(plane_d, 2)*pow(ray_dir_x, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_y, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_z, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2))))*cos(fi)*cos(ka) + (plane_d*ray_dir_y/(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))) - (-ray_dir_y + (plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror)))*(2*ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + 2*ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + 2*ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))))*(ray_length - sqrt(pow(plane_d, 2)*pow(ray_dir_x, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_y, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_z, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2))))*sin(ka)*cos(fi) - (plane_d*ray_dir_y/(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))) - (-ray_dir_z + (plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))*(2*ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + 2*ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + 2*ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))))*(ray_length - sqrt(pow(plane_d, 2)*pow(ray_dir_x, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_y, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_z, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2))))*sin(fi);
delta.coeffRef(1,0) = -py + y_t - (plane_d*ray_dir_x/(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))) - (-ray_dir_x + (2*ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + 2*ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + 2*ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))))*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))))*(ray_length - sqrt(pow(plane_d, 2)*pow(ray_dir_x, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_y, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_z, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2))))*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) - (plane_d*ray_dir_y/(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))) - (-ray_dir_y + (plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror)))*(2*ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + 2*ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + 2*ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))))*(ray_length - sqrt(pow(plane_d, 2)*pow(ray_dir_x, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_y, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_z, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2))))*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + (plane_d*ray_dir_y/(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))) - (-ray_dir_z + (plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))*(2*ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + 2*ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + 2*ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))))*(ray_length - sqrt(pow(plane_d, 2)*pow(ray_dir_x, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_y, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_z, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2))))*sin(om)*cos(fi);
delta.coeffRef(2,0) = -pz + z_t - (plane_d*ray_dir_x/(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))) - (-ray_dir_x + (2*ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + 2*ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + 2*ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))))*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))))*(ray_length - sqrt(pow(plane_d, 2)*pow(ray_dir_x, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_y, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_z, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2))))*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) - (plane_d*ray_dir_y/(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))) - (-ray_dir_y + (plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror)))*(2*ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + 2*ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + 2*ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))))*(ray_length - sqrt(pow(plane_d, 2)*pow(ray_dir_x, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_y, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_z, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2))))*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) - (plane_d*ray_dir_y/(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))) - (-ray_dir_z + (plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))*(2*ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + 2*ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + 2*ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc)))))*(ray_length - sqrt(pow(plane_d, 2)*pow(ray_dir_x, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_y, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2) + pow(plane_d, 2)*pow(ray_dir_z, 2)/pow(ray_dir_x*(plane_a*cos(fic)*cos(kac) + plane_b*(sin(fic)*sin(om_mirror) - sin(kac)*cos(fic)*cos(om_mirror)) + plane_c*(sin(fic)*cos(om_mirror) + sin(kac)*sin(om_mirror)*cos(fic))) + ray_dir_y*(plane_a*(sin(fic)*sin(omc)*cos(kac) + sin(kac)*cos(omc)) + plane_b*((-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*cos(om_mirror) - sin(om_mirror)*sin(omc)*cos(fic)) + plane_c*(-(-sin(fic)*sin(kac)*sin(omc) + cos(kac)*cos(omc))*sin(om_mirror) - sin(omc)*cos(fic)*cos(om_mirror))) + ray_dir_z*(plane_a*(-sin(fic)*cos(kac)*cos(omc) + sin(kac)*sin(omc)) + plane_b*((sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*cos(om_mirror) + sin(om_mirror)*cos(fic)*cos(omc)) + plane_c*(-(sin(fic)*sin(kac)*cos(omc) + sin(omc)*cos(kac))*sin(om_mirror) + cos(fic)*cos(om_mirror)*cos(omc))), 2))))*cos(fi)*cos(om);
}
